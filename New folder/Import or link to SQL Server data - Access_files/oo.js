var customWTPVLogging=null;Type.registerNamespace("OOC");window.onerror=ReportScriptError;function HideScriptError(){return true}function LogSilverlightEvent(c,d){var b="SL plugin: ";try{var f=typeof Zone!="undefined"?Zone:"",a=String.format("/uls/reportscripterror.aspx?Source={0}&Error={1}&Trace={2}&Browser={3}",escape(b+c+" at: "+window.location),escape(d),"none",escape(navigator.userAgent));a=OOUtil.AppendCorrelationIdToUrl(a);var a="/uls/reportscripterror.aspx".StrAddUniqueParam("Source",escape(b+c+" at: "+window.location)).StrAddUniqueParam("Error",escape(d)).StrAddUniqueParam("Trace","none").StrAddUniqueParam("Browser",escape(navigator.userAgent)).StrAddUniqueParam("Zone",escape(f)),e=new Image;e.src=a}catch(g){}}function ReportScriptError(c,d,b){try{if(!c)c="Undefined error.";if(!d)d=window.location.href;if(!b)b=0;var g=typeof Zone!="undefined"?Zone:"";window.onerror=HideScriptError;var e=String.format("Line: {0}, Error: {1}",b,c),a=String.format("/uls/reportscripterror.aspx?Source={0}&Error={1}&Trace={2}&Browser={3}&Zone={4}",escape(window.location),escape(e),escape(GetStackTrace()),escape(navigator.userAgent),escape(g));a=OOUtil.AppendCorrelationIdToUrl(a);var f=new Image;f.src=a}catch(h){}return true}function GetStackTrace(){var a;if(arguments.caller&&arguments.caller.caller)a=arguments.caller.caller;if(!a)return "UnknownFunction";var c="";while(a!=null&&a.callee!=null&&a.caller!=a){var b=a.callee.toString();b=b.substring(9,b.indexOf(")")+1);c+=b+"; ";a=a.caller}return c}(typeof Function==="undefined"||typeof Sys==="undefined")&&ReportScriptError("MicrosoftAjax has failed to load.");(typeof jQuery==="undefined"||typeof $==="undefined")&&ReportScriptError("jQuery has failed to load.");typeof OOUI==="undefined"&&ReportScriptError("Global JsonStrings has failed to load.");(typeof Microsoft==="undefined"||typeof GlobalSvc==="undefined")&&location.protocol!="https:"&&ReportScriptError("GlobalSvc has failed to load.");$(function(){document.write=function(){for(var a=0;a<arguments.length;a++)$("body").append(arguments[a])}});function GetXmlHttp(){var a=false;if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)a=new ActiveXObject("Microsoft.XMLHTTP");return a}OOC.AssetId=function(c){var b=null,a=this;a.nAssetTypeLength=2;a.nNumericLength=9;a.nAssetIdLength=a.nAssetTypeLength+a.nNumericLength;a.strAssetId=c?jQuery.trim(c):b;a.strAssetType=b;a.strNumericAssetId=b;a.Str=b;a.initialize()};OOC.AssetId.prototype={initialize:function(){var a=this;if(a.strAssetId&&a.strAssetId.length==a.nAssetIdLength){a.strAssetType=a.strAssetId.substr(0,a.nAssetTypeLength);a.strNumericAssetId=a.strAssetId.substr(a.nAssetTypeLength);a.Str=a.Validate()?a.strAssetId:null}},AiFromStr:function(b){var a=this,c=null;if(b){a.strAssetId=jQuery.trim(b);a.initialize();if(a.Validate()){c=new OOC.AssetId(a.strAssetType+a.strNumericAssetId);a.strAssetId=a.strAssetType=a.strNumericAssetId=a.Str=null}}return c},AiFromParts:function(c,b){var a=this,d=null;if(c&&b){a.strAssetType=c;a.strNumericAssetId=b;if(a.Validate()){d=new OOC.AssetId(a.strAssetType+a.strNumericAssetId);a.strAssetId=a.strAssetType=a.strNumericAssetId=a.Str=null}}return d},Validate:function(){var a=this;if(!a.strAssetId||!a.strAssetType||!a.strNumericAssetId)return false;return !OOUtil.IsNumeric(a.strAssetType)&&OOUtil.IsNumeric(a.strNumericAssetId)&&a.strAssetType.length==a.nAssetTypeLength&&a.strNumericAssetId.length==a.nNumericLength},dispose:function(){var a=this;a.strAssetId=a.strAssetType=a.strNumericAssetId=a.Str=null}};OOC.AssetId.registerClass("OOC.AssetId",Sys.Component);var AssetId=new OOC.AssetId;function dcsOO(){var a="undefined";if(typeof WebTrends===a)return;if(typeof window.WebTrendsImpl===a||!window.WebTrendsImpl)window.WebTrendsImpl=new WebTrends;else window.WebTrendsImpl.dcsCleanUp();if(arguments.length==0){window.WebTrendsImpl.dcsGetId();window.WebTrendsImpl.dcsCollect()}else{window.WebTrendsImpl.dcsVar();window.WebTrendsImpl.dcsMeta();window.WebTrendsImpl.dcsAdv();if(arguments.length%2!=0){window.WebTrendsImpl.DCSdir.ClearVars+=arguments[arguments.length-1];arguments.length-=1}window.WebTrendsImpl.dcsMSClearVars();window.WebTrendsImpl.dcsMultiTrack.apply(window.WebTrendsImpl,arguments)}}function LogToAzure(f,c,a){var d=null;if(typeof g_auth!="undefined"&&g_auth!=d&&!g_auth)return;var b="",e=AssetId.AiFromStr(f);if(e==d)return;switch(e.strAssetType){case "HA":case "HP":case "HV":b="Assistance";break;case "TC":b="Templates";break;case "RZ":b="Training";break;case "VA":b="Videos";break;default:return}if(c==d)c="Viewed";if(OOUI.AzureAllowedActions.indexOf(b+c)==-1)return;if(a==d)a=0;if(c=="Rated"){if(a<50)return;a=a/25+1}$.get("azurelogging.aspx",{as:b,ala:c,AssetId:e.Str,rating:a})}function G(a){if(a&&typeof a=="string")a=document.getElementById?document.getElementById(a):null;return a&&typeof a=="object"?a:null}function GS(a){a=G(a);return a?a.style:null}function StrGetDisplay(a){a=GS(a);return a?a.display:""}function SDsply(a,b){a=GS(a);if(a)a.display=b}function SDsplyH(a){SDsply(a,"none")}function SDsplyS(a){SDsply(a,"")}function TDsply(b,a){SDsply(b,StrGetDisplay(b)==a?"none":a)}function FVis(a){return StrGetDisplay(a)!="none"}function SWdth(a,b){a=GS(a);if(a)a.width=b}function SWdthNF(a){SWdth(a,"100%")}function TDB(a){TDsply(a,"block");return false}function FSClk(a){return a&&a.button<=1&&a.shiftKey}function FSEnt(a){return a&&a.keyCode==13&&a.shiftKey}function GHlp(b){var a=window.navigator.appName.toUpperCase().indexOf("NETSCAPE")>=0?",scrollbars=1":"";window.open(b,"_hlp011","toolbar=0,status=0,menubar=0"+a+",resizable=1,width=260,height="+Math.round(window.screen.availHeight*2/3));return false}function ConvertAppCodeToActiveXCompatible(a){if(typeof a==="undefined"||a==null)return null;if(a.length===3&&a.charAt(0)==="Z")a=a.substring(1,3);if(a==="IP")a="XD";else if(a==="SPD")a="SDR";return a}function CVDetectApplications(a){var b=GetCookie("_ofcapp",null);if(b&&(b.indexOf("140")!=-1||b.indexOf("150")!=-1))return false;var c=OOUtil.ScriptReference(OOUI.AxControlsJsUrl+"&reqver=0",function(){var b="undefined";if(typeof DCTRL===b||typeof DCTRL.GetInstalledVersion===b)return false;if(typeof a!=b&&a){for(var e=[],g=[],d,h=0;h<a.avs.length;h++){d=a.avs[h].substring(0,3);jQuery.inArray(d,e)<0&&e.push(d)}for(var f=0;f<e.length;f++){d=ConvertAppCodeToActiveXCompatible(e[f]);var c;try{if(typeof DCTRL.DetectAppVersion!==b)c=DCTRL.DetectAppVersion(d);else c=DCTRL.GetInstalledVersion(d);if(typeof c!=b&&!(c>=11&&c<=15))continue}catch(k){}var i=typeof c!=b&&c&&!isNaN(c)?c.toString()+"0":null;i&&g.push(e[f]+i)}}if(g.length>0){var j=g.join("-");SetPersistentCookie("_ofcapp",j)}});OOUtil.JSAsyncLoader(c)}var OOUtil={rgLoadedScripts:[],nMsTimeOut:5e3,strRedirUrl:"{0}{1}/redir/{2}.aspx",evtHash:[],strOptionalSearchHash:null,Timer:function(a,b){if(typeof a=="function")if(arguments&&arguments.length>2){var d=Array.prototype.slice.call(arguments,2),c=function(){a.apply(null,d)};return window.setTimeout(c,b)}else return window.setTimeout(a,b);else if(typeof a=="string")return window.setTimeout(a,b)},createElement:function(c,e,b,d){var a;if(c)try{a=$get(c);if(a)return a}catch(f){}if(!b)b="div";try{a=document.createElement(b);if(c)a.id=c;if(d)a.className=d;if(b=="a")a.href="javascript:void(0)";e&&e.appendChild(a)}catch(f){}try{return a}finally{a=null}},preventDefaultAction:function(a){if(a)if(typeof a.preventDefault!="undefined")a.preventDefault();else a.returnValue=false;return false},GetQueryStringArray:function(){return OOUtil.GetParamsFromUrl(window.location.href)},GetParamsFromUrl:function(b){var e={},d=b.indexOf("?"),g=b.indexOf("#"),c;if(g<0)c=b.substring(d+1);else c=b.substring(d+1,g);if(d!==-1&&c.length>0)for(var h=c.split("&"),f=0;f<h.length;f++){var a=h[f].split("=");if(a.length==2)e[unescape(a[0])]=unescape(a[1]);else if(a.length==1)e[unescape(a[0])]=unescape(a[0])}return e},AppendParamToUrl:function(a,b,c){if(a){a+=a.indexOf("?")<0?"?":"&";a+=escape(b);a+="=";a+=escape(c)}return a},CorrelationId:function(){return typeof g_strCorrId!=="undefined"?g_strCorrId:""},AppendCorrelationIdToUrl:function(a){var b=OOUtil.CorrelationId();if(b.length>0)a=a.StrAddUniqueParam("corr",escape(b));return a},RavLinkUrl:function(c,d){var a=new Sys.StringBuilder;a.append(OOUI.RlidCSxRAV14);c&&a.append(String.format("&q306={0}",escape(c)));a.append(String.format("&q307={0}",escape(location.href)));var b=AssetId.AiFromStr(d);b&&b.strAssetType&&a.append(String.format("&q308={0}",escape(b.strAssetType)));return a.toString()},RedirectUrl:function(a,b,e,j,g,f,d,i,h){if(!a||!b)return null;var c=typeof g_strRenderingSiteRootRelative!=="undefined"?g_strRenderingSiteRootRelative:"/";return String.format(OOUtil.strRedirUrl,c,b,a).StrAddUniqueParam("CTT",e).StrAddUniqueParam("Origin",encodeURIComponent(j)).StrAddUniqueParam("QueryID",g).StrAddUniqueParam("respos",f).StrAddUniqueParam("ibb",d).StrAddUniqueParam("xc",i).StrAddUniqueParam("qu",encodeURIComponent(h))},Navigate:function(a){window.location.href=a},getSrcElement:function(a){if(a&&a.target)return a.target;else if(a&&a.srcElement)return a.srcElement;return null},GetParentElement:function(a){return a.parentElement?a.parentElement:a.parentNode},DeleteChildren:function(a){if(a!=null&&a.children!=null&&a.children.length>0)for(var b=a.children.length;b>0;b--){var c=a.children[b-1];a.removeChild(c)}if(a&&a.innerHTML)a.innerHTML=""},DeleteChildByName:function(a,d){if(a!=null&&a.childNodes!=null&&a.childNodes.length>0)for(var c=a.childNodes.length;c>0;c--){var b=a.childNodes[c-1];b&&b.id==d&&a.removeChild(b)}},DeleteNode:function(b){var a=this.GetParentElement(b);a&&a.removeChild(b)},GetChild:function(a,b){if(typeof b=="undefined")b=0;if(a&&a.children!=null&&a.children.length>b)return a.children(b);return null},NodeContains:function(b,a){while(a&&b!=a&&a!=null)a=a.parentNode;return b==a},DeleteOptions:function(a){if(a)for(var b=a.options.length-1;b>=0;b--)a.remove(b)},GetViewport:function(){var a={};a.innerHeight=window.innerHeight?window.innerHeight-18:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:null;a.innerWidth=window.innerWidth?window.innerWidth-18:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:null;return a},getClientBounds:function(){var b,a;switch(Sys.Browser.agent){case Sys.Browser.InternetExplorer:b=document.documentElement.clientWidth;a=document.documentElement.clientHeight;break;case Sys.Browser.Safari:b=window.innerWidth;a=window.innerHeight;break;case Sys.Browser.Opera:b=Math.min(window.innerWidth,document.body.clientWidth);a=Math.min(window.innerHeight,document.body.clientHeight);break;default:b=Math.min(window.innerWidth,document.documentElement.clientWidth);a=Math.min(window.innerHeight,document.documentElement.clientHeight)}return new Sys.UI.Bounds(0,0,b,a)},GetScrollOffset:function(){var b="undefined",a={};if(typeof window.pageYOffset!=b){a.pageXOffset=window.pageXOffset;a.pageYOffset=window.pageYOffset}else if(document.documentElement&&typeof document.documentElement.scrollTop!=b){a.pageXOffset=document.documentElement.scrollLeft;a.pageYOffset=document.documentElement.scrollTop}return a},AnimateScrollTo:function(a){var b="undefined";if(!a)return;if(typeof window.pageYOffset!=b)$(window).animate({pageYOffset:a});else document.documentElement&&typeof document.documentElement.scrollTop!=b&&$(document.documentElement).animate({scrollTop:a})},VerifyMultiLineText:function(b){var a=$(b);return a.height()>parseFloat(a.css("font-size"))*1.75},GetWindowSizeAndScroll:function(){var b=this,a={};a.width=b.GetSmallestNonZeroNumber([window.innnerWidth?window.innerWidth:0,document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:0,document.body&&document.body.clientWidth?document.body.clientWidth:0]);a.height=b.GetSmallestNonZeroNumber([window.innnerHeight?window.innnerHeight:0,document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:0,document.body&&document.body.clientHeight?document.body.clientHeight:0]);a.scrollX=b.GetSmallestNonZeroNumber([window.pageXOffset?window.pageXOffset:0,document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:0,document.body&&document.body.scrollLeft?document.body.scrollLeft:0]);a.scrollY=b.GetSmallestNonZeroNumber([window.pageYOffset?window.pageYOffset:0,document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:0,document.body&&document.body.scrollTop?document.body.scrollTop:0]);a.widthScroll=document.all?Math.max(Math.max(document.documentElement.offsetWidth,document.documentElement.scrollWidth),document.body.scrollWidth):document.body?document.body.scrollWidth:document.documentElement.scrollWidth!=0?document.documentElement.scrollWidth:0;a.heightScroll=document.all?Math.max(Math.max(document.documentElement.offsetHeight,document.documentElement.scrollHeight),document.body.scrollHeight):document.body?document.body.scrollHeight:document.documentElement.scrollHeight!=0?document.documentElement.scrollHeight:0;return a},GetSmallestNonZeroNumber:function(c){for(var b=0,a=0;a<c.length;a++)if(c[a]&&(!b||c[a]<b))b=c[a];return b},setAlt:function(a,b){if(!(a&&b))return;if(a.tagName&&a.tagName.toLowerCase()=="img")a.alt=b;a.title=b},GetDatetimeNow:function(){var a=new Date;return a.format("yyyy-MM-dd HH:mm:ssZ")},GetTimestampNow:function(){return (new Date).getTime()},Serialize:function(a){return Sys.Serialization.JavaScriptSerializer.serialize(a)},Deserialize:function(a){return Sys.Serialization.JavaScriptSerializer.deserialize(a)},FIsRtl:function(){if(typeof fIsRTL!="undefined")return fIsRTL;var a=$("body").attr("dir");if(a!=null&&a.toLowerCase()=="rtl")return true;var b=$("html").attr("dir");if(b!=null&&b.toLowerCase()=="rtl")return true;return false},Dir:function(){if(this.FIsRtl())return "rtl";else return "ltr"},GetTrustLevelCookie:function(){var a=GetCookie("AWS_TrustLevel","1");if(OOUtil.IsNumeric(a))return parseInt(a)},SetTrustLevelCookie:function(a){SetPersistentCookie("AWS_TrustLevel",a)},GenerateGuid:function(){var b,c,a;b="";for(a=0;a<32;a++){if(a==8||a==12||a==16||a==20)b+="-";c=Math.floor(Math.random()*16).toString(16).toUpperCase();b+=c}return b},GetFileFromUrl:function(){return window.location.href.substring(window.location.href.lastIndexOf("/")+1)},FIsBrowserIE9:function(){return document.documentMode&&document.documentMode==9},FIsBrowserIE8:function(){return document.documentMode&&document.documentMode==8},FIsBrowserIEQuirks:function(){return Sys.Browser.agent==Sys.Browser.InternetExplorer&&Sys.Browser.version==6||document.documentMode&&document.documentMode==5},FIsCanvasSupported:function(){return !!window.HTMLCanvasElement},IsNumeric:function(a){return !isNaN(parseInt(a))},IntValidate:function(a,b){return OOUtil.IsNumeric(a)?parseInt(a):b},AssetIdValidate:function(b,a){ai=AssetId.AiFromStr(b);return ai&&ai.Str?ai.Str:a},UrlValidate:function(b){var c=new RegExp("^(?:(?:https?)://)(?:\\S+(?::\\S*)?@)?(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})+)*(?::\\d{2,5})?(?:/[^\\s]*)?$","i"),a=c.exec(b);return !(a===null||a[0]!==b)},ArrayValidate:function(c,g,e,i){var d="string",h="undefined",a,f=true;if(typeof c===h||typeof e===h||c==null||e==null)return null;if(typeof c===d&&g)a=c.split(g);else if(typeof c==="object")a=c;for(var b=0;b<a.length;b++){if(e==="number")if(OOUtil.IsNumeric(a[b]))a[b]=parseInt(a[b]);else{f=false;break}if(e===d)if(typeof a[b]===d)a[b]===OOUtil.HtmlEncode(a[b]);else{f=false;break}}return f?typeof c===d?a.join(g):a:i},HtmlEncode:function(a){if(a==null)return null;return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},HtmlDecode:function(a){if(a==null)return null;return a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},ZeroPad:function(a,d,b){b=typeof b!="undefined"?b:false;for(var c=a.length;c<d;c++)a=b?"0"+a:a+"0";return a},GetOlsSupportedApps:function(){var a=null,c=GetCookie("ols",a);if(c!=a)try{var b=OOUtil.Deserialize(c);if(b&&typeof b.apps!=="undefined")return b.apps}catch(d){return a}return a},GetOfficeSuiteVersion:function(d){var c="function",g="undefined",b=null,a=GetCookie("ov",b),f=true;if(a!=b&&OOUtil.IsNumeric(a))a=parseInt(a);else if(typeof MSOJS!==g&&typeof MSOJS.ClientUtils!==g&&typeof MSOJS.ClientUtils.OfficeVersionInstalled===c){a=OOUtil.DetectOfficeSuiteVersion();if(OOUtil.IsNumeric(a)){var e=new Date;e.setDate(e.getDate()+1);mSetCookie("ov",a.toString(),false,e)}}else{f=false;var h=OOUtil.ScriptReference(OOUI.ClientUtilsJsUrl,function(){a=OOUtil.DetectOfficeSuiteVersion();if(OOUtil.IsNumeric(a)){var e=new Date;e.setDate(e.getDate()+1);mSetCookie("ov",a.toString(),false,e)}typeof d===c&&d.apply(b,[a])});OOUtil.JSAsyncLoader(h);a=-1}f&&typeof d===c&&d.apply(b,[a]);return a},DetectOfficeSuiteVersion:function(){var a="undefined",b=-1;if(typeof MSOJS!==a&&typeof MSOJS.ClientUtils!==a&&typeof MSOJS.ClientUtils.OfficeVersionInstalled==="function")try{b=MSOJS.ClientUtils.OfficeVersionInstalled()}catch(c){ReportScriptError(String.format("error detecting Office suite version. Error:'{0}'",c))}return b},FocusAndSetCursorToEnd:function(a){if(!a)return;var b=0;if(a.value)b=a.value.length;a.focus();if(a.createTextRange){var c=a.createTextRange();c.move("character",b);c.select();a.select()}else a.selectionStart&&a.setSelectionRange(0,b)},SetFocus:function(a){window.setTimeout(function(){try{a.focus()}catch(b){}},170)},DvEnsureModalCoverExists:function(){var a=$("#dvModalCover");if(a.size()===0)a=$("<div/>").addClass("dvModalBackground").attr("id","dvModalCover").appendTo(document.body);return a},ScriptReference:function(h,c,b,g,f){var e="undefined",d="function",a={};a.src=h;a.load=typeof c===d?c:null;a.error=typeof b===d?b:null;a.type=typeof g!==e?g:"script";a.enableCache=typeof f!==e?f:true;return a},CreateGuid:function(){for(var a="",b=0;b<32;b++)a=a+Math.floor(Math.random()*16).toString(16).toLowerCase();return a},JSAsyncLoader:function(){var g="stylesheet",c=null,b="function";if(arguments&&arguments.length)try{for(var i=$("head"),f=Array.prototype.slice.call(arguments,0),j,h=this,e=0;e<f.length;e++){var a=f[e];if(typeof a!=="object"||typeof a.src==="undefined")continue;if(!Array.contains(OOUtil.rgLoadedScripts,a.src)){if(a.type==="script")var l=$.ajax({url:a.src,dataType:"script",cache:a.enableCache}).done(function(d,c){if(c==="success"&&typeof a.load===b){h.rgLoadedScripts.push(a.src);a.load.call()}}).fail(function(){typeof a.error===b&&a.error.apply(c,arguments)});else if(a.type===g){window.callbackCalled=false;var m=$("<link/>").attr({id:"css-"+this.CreateGuid(),rel:g,type:"text/css",href:a.src}).load(function(c){if(c&&c.target)if((c.target.readyState==="complete"||c.target.readyState==="loaded")&&typeof a.load===b&&!window.callbackCalled){h.rgLoadedScripts.push(a.src);a.load.call();window.callbackCalled=true}}).error(function(){typeof a.error===b&&a.error.apply(c,arguments)}).appendTo(i);if(!$.browser.msie&&typeof a.load===b&&!window.callbackCalled){var d=document.createElement("img");d.onerror=function(){a.load.call();window.callbackCalled=true;document.body.removeChild(d)};d.style="display:none";d.src=a.src;$(document.body).append(d)}}}else typeof a.load===b&&a.load.call()}}catch(k){}finally{j=c;window.callbackCalled=c}},JSAsyncLoaderInline:function(){if(arguments&&arguments.length)try{for(var b=Array.prototype.slice.call(arguments,0),a=0;a<b.length;a++){if(typeof b[a]!="object"||typeof b[a].src==="undefined")continue;if(!Array.contains(OOUtil.rgLoadedScripts,b[a].src)){var d=Function.createCallback(this.JSAppend,{ScriptRef:b[a],self:this}),c=new Sys.Net.WebRequest;c.set_url(b[a].src);c.set_httpVerb("GET");c.set_timeout(OOUtil.nMsTimeOut);c.add_completed(d);c.invoke()}else typeof b[a].load==="function"&&b[a].load.call()}}catch(e){}},JSAppend:function(d,f,a){var c=null;if(d.get_responseAvailable()){var b;try{b=new Sys._ScriptLoader;b.queueScriptBlock(d.get_responseData());b.loadScripts(0,c,c,c);Array.add(a.self.rgLoadedScripts,a.ScriptRef.src);b.dispose()}catch(e){}finally{b=c;a.ScriptRef.load&&a.self.Timer(a.ScriptRef.load,0)}}else if(d.get_aborted()&&a.ScriptRef.error)a.ScriptRef.error.call();else d.get_timedOut()&&a.ScriptRef.timeout&&a.ScriptRef.timeout.call()},SpliceInBreakSuggestions:function(a){if(!a||!a.length)return a;for(var e="&#8203;",c=40,d="",b=0;b<a.length;b+=c)d+=a.substr(b,c)+e;return d},IsDefined:function(a){if(typeof a==="undefined")return false;return true},GetHashCode:function(b){var d=typeof b;if(d==="undefined")return 0;if(d!=="string")b=b.toString();for(var a=0,c=0;c<b.length;c++){a=a<<1;a=a^b.charCodeAt(c);a=a^c;if(a<0)a=~a}return a},GetStaticContentDomainUrl:function(a,e){var d="undefined";if(!a||!a.length)return a;if(a.indexOf("://")>=0)return a;if(!OOUtil.IsDefined(OOUI)||!OOUtil.IsDefined(OOUI.StaticContentDomains)||!OOUI.StaticContentDomains.length)return a;if(a.indexOf("/")!=0){var b=document.location.pathname;b=b.substr(0,b.lastIndexOf("/")+1);a=b+a}var f=OOUtil.GetHashCode(a),c;if(typeof e!=d&&e)if(typeof OOUI.InternalStaticContentDomain!=d)c=OOUI.InternalStaticContentDomain;else return a;else c=OOUI.StaticContentDomains[f%OOUI.StaticContentDomains.length];return document.location.protocol+"//"+c+a},GetCodeImage:function(d,b){var c="5690.4000";if(!d)return null;var a="/_layouts/images/"+d+"/"+(b?b:"");if(a.indexOf("b=")===-1)if(a.indexOf("?")===-1)a=a+"?b="+c;else a=a+"&b="+c;return OOUtil.GetStaticContentDomainUrl(a)},IsTouSet:function(d){var a=false;switch(d){case OOUI.TOU:var b=GetCookie(d),e;if(typeof g_llcc!="string"||b=="")return a;e=g_llcc.toLowerCase();var h=b.toLowerCase().indexOf(e);if(h==-1)return a;var c=h+e.length+1;if(c>b.length)return a;var f=b.indexOf(":",c),g=f==-1?b.length-c:f-c;if(g<=0)return a;if(b.substr(c,g)==OOUI.IDS_TOU_VERSION)return true;return a;case OOUI.TOU_CST:case OOUI.TOU_MS:case OOUI.TOU_ISV:return GetCookie(d)=="1"}return a},IsAnchorEnabled:function(b){var c=$("#"+b),a=c.attr("href");if(typeof a==="undefined"||a.length==0)return false;return true},EnableLink:function(f,e){var d="disabled",b="href",a=$("#"+f),c=a.attr(b);if(e){a.removeAttr(d);!document.all&&(typeof c==="undefined"||c.length==0)&&a.attr(b,a.attr("hrefbak"))}else{a.attr(d,true);a.attr("hrefbak",c);!document.all&&a.removeAttr(b)}},EnableLinkButton:function(a,e){var d="cdBtnDisabled",c="disabled",b=" > table";OOUtil.EnableLink(a,e);if(e){$("#"+a+b).attr(c,false);$("#"+a).removeClass(d)}else{$("#"+a+b).attr(c,true);$("#"+a).addClass(d)}},rgWindowedItems:[],HideVideoControls:function(){if(OOUtil.rgWindowedItems==null)return;$.each(OOUtil.rgWindowedItems,function(c,b){var a=$("#"+b.id);if(a!=null&&a.length>0){a.css("background-color",b.bgcolor);a.children().css("visibility","hidden")}})},ShowVideoControls:function(){if(OOUtil.rgWindowedItems==null)return;$.each(OOUtil.rgWindowedItems,function(c,b){var a=$("#"+b.id);if(a!=null&&a.length>0){a.css("background-color",b.oldbgcolor);a.children().css("visibility","visible")}})},UpdateAuthUrlWhenHashChanges:function(){window.lastHash=window.location.hash;var a=function(){if(window.location.hash!=window.lastHash){window.lastHash=window.location.hash;OOUtil.UpdateAuthUrl()}};if("onhashchange" in window)$addHandler(window,"hashchange",a);else window.setInterval(a,200)},UpdateAuthUrl:function(){var a=encodeURIComponent(encodeURIComponent(window.location.hash));$(".authLink").attr("href",function(c,b){if(b=="javascript:void(0);")return b;else return g_AuthUrlTemplate.replace(g_HashToken,a)})},LoadO365Toolbar:function(a){if(a&&a.NavBarDataJson&&a.SharedJSUrl&&a.SharedCSSUrl){var b=typeof a.NavBarDataJson==="string"?OOUtil.Deserialize(a.NavBarDataJson):a.NavBarDataJson,c=OOUtil.ScriptReference(a.SharedCSSUrl,function(){var c=OOUtil.ScriptReference(a.SharedJSUrl,function(){var a="#dvNavBar365Fallback",c="dvO365Container";if(typeof O365_NavBar!=="undefined"){$("#cdpartnertopnav").append($("<div/>").attr("id",c));$(a).hide();try{O365_NavBar.Render(c,b,null)}catch(d){ReportScriptError(String.format("error calling the O365 NavBar script. Error:'{0}'",d))}OOUtil.Timer(function(){var b=$("#dvO365Container");if(b.outerHeight(true)>40||b.children().size()===0){b.hide();$(a).show();return false}$("#O365_SubLink_ShellSignout").attr("href",$(".authLink").attr("href"))},500)}},function(){ReportScriptError(String.format("Error loading the O365 NavBar JS file. Url:'{0}'",a.SharedJSUrl))},"script",false);OOUtil.JSAsyncLoader(c)},function(){ReportScriptError(String.format("Error loading the O365 NavBar CSS file. Url:'{0}'",a.SharedCSSUrl))},"stylesheet");OOUtil.JSAsyncLoader(c)}},ValidateMultilineElems:function(c,b,a){if(c.size()===0)return false;if(typeof a==="undefined")a=false;c.each(function(){var c=$(this);if(OOUtil.VerifyMultiLineText(c))if(a)c.parent().addClass(b);else c.addClass(b)})},GetMinNavbarAndFooterWidth:function(){var a=true,b=0+$("#cdCntPane").outerWidth(a),c=5+$("#dvFooterLinks").outerWidth(a)+$("#spnFooterCopyright").outerWidth(a),d=5+$("#dvOfficeLogo").outerWidth(a)+$("#dvNavBarLinkContainer").outerWidth(a);return Math.max(b,c,d)}},webStorageFeature="Storage";if(webStorageFeature in window&&window[webStorageFeature]!==null)Storage.prototype.setObject=function(b,a){this.setItem(b,OOUtil.Serialize(a))};if(webStorageFeature in window&&window[webStorageFeature]!==null)Storage.prototype.getObject=function(a){return this.getItem(a)&&OOUtil.Deserialize(this.getItem(a))};OOC.StorageObject=function(a){var d=null,c="undefined",b=this;if(typeof a!==c){b.key=d;b.data=typeof a.data!==c?a.data:d;b.market=typeof a.market!==c?a.market:d;b.CID=typeof a.CID!==c?a.CID:d;b.created=d;b.duration=typeof a.duration!==c?a.duration:0;b.timedivisor=1e3*60;b.savedcallback=typeof a.savedcallback!==c?a.savedcallback:d;b.timeoutcallback=typeof a.timeoutcallback!==c?a.timeoutcallback:d}else throw"Storage Obj options are undefined"};OOC.StorageObject.registerClass("OOC.StorageObject",Sys.Component);OOC.WebStorage=function(c,a){var e="localStorage",d="undefined",b=this;if(typeof c===d||c===null){throw"WebStorage masterkey is undefined";return false}if(typeof a===d||a===null){throw"storageType is undefined";return false}if(!(a===e||a==="sessionStorage"))throw String.format("Invalid storageType passed in: '{0}'",a);try{b.supportsWebStorage=a in window&&window[a]!==null}catch(f){!(Sys.Browser.agent==Sys.Browser.InternetExplorer&&Sys.Browser.version==7||OOUtil.FIsBrowserIEQuirks())&&ReportScriptError(String.format("Exception occured verifying WebStorage support. Error: '{0}'",f));b.supportsWebStorage=false}b.masterKey=c;if(b.supportsWebStorage)b.StorageLocation=a===e?window.localStorage:window.sessionStorage;b.Load();OOC.Timers.AddGlobalTimerEvent("WebStorage"+c,Function.createDelegate(b,b.ValidateCache))};OOC.WebStorage.prototype={Load:function(){var a=this;try{if(a.supportsWebStorage)a.Dictionary=a.StorageLocation.getItem(a.masterKey)!=null?OOUtil.Deserialize(a.StorageLocation.getItem(a.masterKey)):{};else a.Dictionary={}}catch(b){ReportScriptError("error occured trying to deserialize dictionary in OOC.WebStorage");a.Dictionary={}}},Save:function(){var a=this;try{a.supportsWebStorage&&a.StorageLocation.setItem(a.masterKey,OOUtil.Serialize(a.Dictionary))}catch(b){ReportScriptError("error occured trying to serialize dictionary in OOC.WebStorage")}},Add:function(c,a){var b=this;if(!OOC.StorageObject.isInstanceOfType(a)){throw"You can only add items of type OOC.StorageObject to dictionary";return false}b.ContainsKey(c)&&b.Delete(c);a.key=c;a.market=g_llcc;a.CID=g_cid;a.created=b.getUTCDateTime();b.Dictionary[c]=a;b.Save();a.savedcallback!==null&&typeof window[a.savedcallback]==="function"&&window[a.savedcallback].call()},Delete:function(a){if(this.ContainsKey(a))delete this.Dictionary[a];this.Save()},Get:function(b){var a=this.Dictionary[b];return typeof a!=="undefined"?a:null},ContainsKey:function(a){return typeof this.Dictionary[a]!=="undefined"},ValidateCache:function(c){var b=this;if(typeof c!=="boolean")c=false;for(var d in b.Dictionary){var a=b.Dictionary[d];if(b.hasExpired(a)&&a.duration!=0||c){b.Delete(d);a.timeoutcallback!==null&&typeof window[a.timeoutcallback]==="function"&&window[a.timeoutcallback].call()}}},getUTCDateTime:function(){var a=new Date;return Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())},hasExpired:function(a){var c=this.getUTCDateTime(),b=a.created;return c&&b&&a.duration?parseInt(c/a.timedivisor)-parseInt(b/a.timedivisor)>a.duration:false},ValidateItem:function(a,c){var b="undefined";if(a===null||a.data!==b&&a.data===null)return false;if(c!==null){if(typeof a.market!==b&&typeof c.market!==b&&a.market!=c.market)return false;if(typeof a.CID!==b&&typeof c.CID!==b&&a.CID!=c.CID)return false}return true},Length:function(){var a=0;if(this.Dictionary==null)return a;for(var b in this.Dictionary)a++;return a}};OOC.WebStorage.registerClass("OOC.WebStorage",Sys.Component);var globalStore;OOC.Timers=function(){var a=this;OOC.Timers.initializeBase(a);a.globalTimer=null;a.globalDelay=null;a.globalCallbacks={};a.processGlobalTimerDelegate=null;a.Initialize()};OOC.Timers.prototype={$registerGlobalTimer:function(){this.globalTimer=OOUtil.Timer(this.processGlobalTimerDelegate,this.globalDelay)},Initialize:function(){var a=this;a.processGlobalTimerDelegate=Function.createDelegate(a,a.ProcessGlobalTimer);if(OOUtil.IsDefined(OOUI.AsyncLoggingIntervalMS))a.globalDelay=OOUI.AsyncLoggingIntervalMS;else a.globalDelay=1e3*10;a.$registerGlobalTimer()},ProcessGlobalTimer:function(){$(document).trigger("timer-global");this.$registerGlobalTimer()},AddGlobalTimerEvent:function(b,a){this.globalCallbacks[b]=a;$(document).bind("timer-global",a)},RemoveGlobalTimerEvent:function(a){$(document).unbind("timer-global",this.globalCallbacks[a]);delete this.globalCallbacks[a]}};OOC.Timers.registerClass("OOC.Timers",Sys.Component);OOC.Timers=new OOC.Timers;OOC.Logging=function(){OOC.Logging.initializeBase(this);this.initialize()};OOC.Logging.prototype={initialize:function(){},GetSearchPositionByAid:function(b){if(typeof jsonSearchResults!="undefined")for(var a=0;a<jsonSearchResults.assets.length;a++)if(jsonSearchResults.assets[a].a==b)return a+1;return ""},LogClipDataToWebTrends:function(b,G,J,N,K,L){var M="DCSext.oo_assetid",I="DCSext.WT.z_PositionClicked",H="DCSext.WT.z_rclickTrig",y="DCSext.WT.z_positionDL",x="DCSext.WT.z_assetDL",w="DCSext.WT.z_conv_type",v="DCSext.WT.z_bestbet",u="DCSext.WT.z_teaser",t="DCSext.WT.z_rdlTrig",s="DCSext.oo_hash",r="DCSext.oo_clipdltype",q="DCSext.oo_clipquery",p="DCSext.oo_clipcat",o="DCSext.oo_dltype",n="DCS.dcsref",m="WT.ti",l="WT.dl",k="32",e="1",d=null,c="undefined";if(typeof b==c||b==d)return;var a=typeof G!=c&&G!=d?G:"0",C=typeof jsonSearchResults!=c&&jsonSearchResults.cn!=d?jsonSearchResults.cn:"n/a",j=typeof jsonSearchResults!=c&&jsonSearchResults.qu!=d?jsonSearchResults.qu:"n/a",f=typeof J!=c&&J!=d?J:"n/a",E=typeof K!=c&&K!=d?K:"",h=a==e?e:"",F=h==e?N:"",g=a==k?e:"",D=f=="Teaser"?e:"",B=f=="BestBet"?e:"",z=g==e?"download":"",A=a==k?b:"",i=a==k?this.GetSearchPositionByAid(b):"";if(typeof dcsOO!==c)if(h)if(typeof L!=c&&L!=d)dcsOO(l,a,m,document.title,n,window.location.href,o,b.substr(0,2),p,C,q,j,r,f,s,E,t,g,u,D,v,B,w,z,x,A,y,i,",WT.z_css,WT.oss,DCSext.WT.z_tbb,DCSext.WT.z_searchid,DCSext.WT.z_OriginSubweb,DCSext.WT.z_OriginAssetID,DCSext.WT.z_PerPage,DCSext.WT.z_PageNumber");else dcsOO(l,a,m,document.title,n,window.location.href,o,b.substr(0,2),p,C,q,j,r,f,s,E,"DCSext.WT.z_ClickedAssetID",b,H,h,I,F,t,g,u,D,v,B,w,z,x,A,y,i,",WT.oss");else if(a!="0")dcsOO(l,a,m,document.title,n,window.location.href,o,b.substr(0,2),p,C,q,j,r,f,M,b,s,E,H,h,I,F,t,g,u,D,v,B,w,z,x,A,y,i);else dcsOO(l,a,m,document.title,n,window.location.href,o,b.substr(0,2),p,C,q,j,r,f,M,b,s,E,H,h,I,F,t,g,u,D,v,B,w,z,x,A,y,i,",WT.z_css,WT.oss,DCSext.WT.z_tbb,DCSext.WT.z_searchid,DCSext.WT.z_OriginSubweb,DCSext.WT.z_OriginAssetID,DCSext.WT.z_PageNumber,DCSext.WT.z_PerPage");if(a==k||a=="31")LogToAzure(b,"Downloaded");else(a=="0"||a=="13")&&LogToAzure(b,"Viewed")},LogBlueLineDataToWebTrends:function(a){var e=a.pos!=null?a.pos.toString():"",d=a.bb?"1":"",c=a.dl!=null?a.dl.toString():"",b=a.ai!=null?a.ai:"";typeof dcsOO!=="undefined"&&dcsOO("DCSext.WT.z_ClickedAssetID",b,"DCSext.WT.z_rclickTrig","1","DCSext.WT.z_PositionClicked",e,"DCSext.WT.z_bestbet",d,"WT.dl",c,",WT.oss");c=="1"&&LogToAzure(b)},LogFreetextSearchInfoToWebTrends:function(k,l,g,f,h,e){var t="DCSext.WT.z_SearchAssetID",s="DCSext.WT.z_Position",r="DCSext.WT.z_PerPage",q="DCSext.WT.z_PageNumber",p="DCSext.WT.z_searchTrig",o="DCSext.WT.z_rviewTrig",n="DCSext.WT.z_filter_evt",m="DCSext.oo_hash",b="1",d=null,a="undefined",j=typeof g!=a&&g!=d?g:"",i=typeof f!=a&&f!=d?f:"",v=typeof h!=a&&h!=d?h:"",u=window.location.hash==d?b:"",c="0";if(typeof PrefMan!==a){if(PrefMan.URLManager.ProviderId&&PrefMan.URLManager.ProviderId.length!==0)c=b}else if(typeof UrlManager!==a){if(UrlManager.ProviderId&&UrlManager.ProviderId.length!==0)c=b;if(UrlManager.MediaType&&UrlManager.MediaType!=OOC.MediaType.AllClips)c=b;if(UrlManager.ImageSize&&UrlManager.ImageSize!=OOC.ImageSize.All)c=b}if(typeof e==a||e==d||e==false)var w=this.GetAppliedFiltersForWebTrends();if(typeof dcsOO!==a)if(e)dcsOO(m,v,n,c,o,b,p,u,q,k,r,l,s,i,t,j,",WT.oss");else dcsOO(m,v,n,c,o,b,p,u,q,k,r,l,s,i,"DCSext.WT.z_SearchFilter",w,t,j)},GetAppliedFiltersForWebTrends:function(){var d=null;for(var b=":",j="",m="",k="",n="",h="",o="",e="",g=window.location.search.substring(1).split("&"),c=0;c<g.length;++c){if(g[c]==d)continue;var a=g[c].split("=");if(a[0]==d||a[1]==d)continue;if(a[0]=="av")if(a[1]=="my"){var i=GetCookie("_ofcapp","");if(i!="")i=i.replace("-",",");j="MY="+i.toUpperCase()}else if(g[c].length>0)j="av="+g[c].toUpperCase()+b;else j="av=ALL"+b;else if(a[0]=="mkt")k="mk="+a[1].replace("%2D","-")+b;else if(a[0]=="tl")switch(a[1]){case "1":e="cf=0"+b;break;case "2":e="cf=1"+b;break;case "3":e="cf=2"+b}}for(var l=window.location.hash.substring(1).split("|"),c=0;c<l.length;++c){if(l[c]==d)continue;var a=l[c].split(":");if(a[0]==d||a[1]==d)continue;if(a[0]=="is")n="ms="+a[1]+b;else if(a[0]=="mt")h="mt="+a[1]+b;else if(a[0]=="pn")o="pn="+a[1]+b}if(window.location.href.indexOf("/images")!=-1){m="at=MX"+b;if(n.length==0)mediaSide="ms=0"+b;if(h.length=0)h="mt=0"+b}else if(window.location.href.indexOf("/templates")!=-1)m="at=TC"+b;if(e.length==0)e="cf=1"+b;if(k.length==0)k="mk="+g_llcc+b;var f=j+m+k+n+h+o+e;if(f.lastIndexOf(":")==f.length-1)return f.substring(0,f.length-1);return f}};OOC.Logging.registerClass("OOC.Logging",Sys.Component);OOC.Logging=new OOC.Logging;if(typeof Microsoft==="undefined"){OOC.CTT=function(){};OOC.CTT.prototype={}}else OOC.CTT=Microsoft.OfficeOnline.Rendering.Logging.CTT;OOC.Chrome=function(){OOC.Chrome.initializeBase(this)};OOC.Chrome.prototype={InitSearchBox:function(){var b="cdsrchdef",d=$("#frmSearch"),a=$(d).find("input[type=text]"),e=d.find("span")[0];if(!d||d.length==0||!a||a.length==0||!e||e.length==0)return;var c=$(e).text();$(d).submit(function(i){var e="undefined",a=null,d=$(this).find("input[type='text']");if(d.length==1){d[0].value=$.trim(d[0].value);if(d[0].value.length==0||d[0].value==c){OOUtil.FocusAndSetCursorToEnd(d);alert(OOUI.IDS_ONT_SEARCH_NOTEXTENTERED);return false}var g=a,h=a;if(window.WebTrendsImpl!=a&&typeof(window.WebTrendsImpl!=e)){g=window.WebTrendsImpl.DCSext.oo_assetid;h=window.WebTrendsImpl.WT.cg_n}else{g=$("meta[name='DCSext.oo_assetid']").attr("content");h=$("meta[name='WT.cg_n']").attr("content")}mSetCookie(OOUI.SEARCH_ORIGINASSETID_COOKIENAME,g);mSetCookie(OOUI.SEARCH_ORIGINSUBWEB_COOKIENAME,h);if(typeof window.SearchHash!=e&&window.SearchHash!=a&&window.SearchHash.length>0){i.preventDefault();var b=$(this).attr("action"),f=b.indexOf("?");if(f<0)f=b.indexOf("#");if(f>0)b=b.substr(0,f);b=String.format("{0}?qu={1}&ctt={2}#{3}",b,encodeURIComponent(d[0].value),OOC.CTT.Search,window.SearchHash);OOUtil.Navigate(b)}}});var f=false;$(a).blur(function(){if(this.value.length==0){this.value=c;$(this).addClass(b);f=false}}).focus(function(){var a=this;if(!f&&a.value==c)a.value="";f=true;$(a).removeClass(b);OOUtil.FocusAndSetCursorToEnd(a)}).keypress(function(a){a&&a==13&&$(this).submit()});($(a).val().length==0||$(a).val()==c)&&$(a).val(c).addClass(b);if($(".cdBios").length){var g=new OOC.ProfileDetailsLoader;g.Load()}},InitMeControl:function(){var a=new OOC.SliderMenu("#ancMeControl","#dvMCShadowContainer","Right")},AddBtnFocusEvents:function(){var j="cdBtnRHover",i="cdBtnMHover",h="cdBtnLHover",g="cdBtnRFoc",c=".cdBtnR",f="cdBtnMFoc",b=".cdBtnM",e="cdBtnLFoc",a=".cdBtnL",d="cdBtnDisabled";$(".cdBtn").focus(function(){var h=$(this);if(!h.hasClass(d)){h.find(a).addClass(e);h.find(b).addClass(f);h.find(c).addClass(g)}}).blur(function(){var d=$(this);d.find(a).removeClass(e);d.find(b).removeClass(f);d.find(c).removeClass(g)}).mousedown(function(){var a=$(this);if(a.hasClass(d))return false}).hover(function(){var e=$(this);if(!e.hasClass(d)){e.find(a).addClass(h);e.find(b).addClass(i);e.find(c).addClass(j)}},function(){var d=$(this);d.find(a).removeClass(h);d.find(b).removeClass(i);d.find(c).removeClass(j)});!document.all&&$(".cdBtn > table").removeAttr("onclick");$(".cdBtn[off=true]").each(function(){OOUtil.EnableLinkButton(this.id,false)})},InitAspNetForm:function(){$("form[id='aspnetForm']").attr("action",window.location);$("a[href][rel*='external']").attr("target","_blank")}};OOC.Chrome.registerClass("OOC.Chrome",Sys.Component);OOC.Chrome=new OOC.Chrome;OOC.OnReady={$execute:function(){OOC.OnReady.$PreInit();for(var a in OOC.OnReady){if(a.charAt(0)=="$")continue;var b=OOC.OnReady[a];if(typeof b!=="function")continue;b()}},$PreInit:function(){if(typeof globalStore==="undefined")globalStore=new OOC.WebStorage("GlobalStore","localStorage");window.retryAttempt=2;window.SignInDialog=new OOC.SignInDialog;$("#ancSignIn").attr("aria-haspopup",true).click(function(){window.SignInDialog.Open($(this))});OOUtil.UpdateAuthUrlWhenHashChanges();OOUtil.UpdateAuthUrl()},InitAspNetForm:OOC.Chrome.InitAspNetForm,InitSearchBox:OOC.Chrome.InitSearchBox,InitMeControl:OOC.Chrome.InitMeControl,AddBtnFocusEvents:OOC.Chrome.AddBtnFocusEvents,InitDigitalRiver:function(){var b=".cdDigitalriverlink";if($(b).length>0){var a=OOUtil.GetQueryStringArray();$(b).each(function(){var c=$(this),b=c.attr("href");if(b&&b!=""){for(var d in a)b=OOUtil.AppendParamToUrl(b,d,a[d]);c.attr("href",b)}})}},AppendImageHovers:function(){var c="IsValidHover",b="src",d="normal",a="img[name]";$(".ancHoverImg").each(function(){var h=$(this),e=h.find(a),f=false;if(e.size()>0){var g=new Image;g.src=e.attr("name");e.data(d,e.attr(b)).data("hot",g.src);f=true}h.data(c,f)}).hover(function(){var e=$(this);if(e.data(c)){var d=e.find(a);d.attr(b,d.data("hot"))}},function(){var f=$(this);if(f.data(c)){var e=f.find(a);e.attr(b,e.data(d))}}).focus(function(){var e=$(this);if(e.data(c)){var d=e.find(a);d.attr(b,d.data("hot"))}}).blur(function(){var f=$(this);if(f.data(c)){var e=f.find(a);e.attr(b,e.data(d))}})},SetEllipsisTitleText:function(){$(".cdEllipsis").each(function(){var a=$(this),b=a.attr("title");(b==null||b=="")&&a.attr("title",$.trim(a.text()))})},InitO365NavBar:function(){var a="O365ToolbarData",b=OOUI.O365MarketsNotAllowed!=null&&OOUI.O365MarketsNotAllowed.length>0?jQuery.trim(OOUI.O365MarketsNotAllowed).split(","):[];if(typeof g_fSignedIn==="boolean"&&g_fSignedIn&&typeof g_fProviderType==="string"&&g_fProviderType==="OrgId"&&!Array.contains(b,"all")&&!Array.contains(b,g_llcc)&&typeof globalStore!=="undefined"&&OOC.WebStorage.isInstanceOfType(globalStore)){var c=globalStore.Get(a);if(!globalStore.ValidateItem(c,{market:g_llcc,CID:g_cid}))GlobalSvc.GetO365BoxToolbar(function(b){window.retryAttempt--;if(b!==null){var c=new OOC.StorageObject({data:b,duration:30});globalStore.Add(a,c);OOUtil.LoadO365Toolbar(b)}else window.retryAttempt>0&&OOUtil.Timer(OOC.OnReady.InitO365NavBar,50)});else OOUtil.LoadO365Toolbar(c.data)}},SetNavBarMinWidth:function(){var a="min-width",e=$("#dvNavBarUnauth"),d=$("#dvNavBarLiveId"),c=$("#dvNavBar365Fallback"),b=OOUtil.GetMinNavbarAndFooterWidth();e.size()!==0&&e.css(a,b);d.size()!==0&&d.css(a,b);c.size()!==0&&c.css(a,b)},SetFooterMinWidth:function(){var a=$("#dvFooter");a.size()!==0&&a.css("min-width",OOUtil.GetMinNavbarAndFooterWidth())},EnsureBetaNavElementsFit:function(){$(".cdtopnbeta").each(function(){var d=$(this),a=d.children("span");if(a.size()===2){d.width($(a.get(0)).width());var c=$(a.get(1)),b=c.width()-6,e=OOUtil.FIsRtl()?b:-b;c.css("left",e)}})}};OOC.AppVerCollection=function(b){var a=this;OOC.AppVerCollection.initializeBase(a);a.AppVerList={};a._fnCallback=typeof b==="function"?b:null;a._appVerDataLoaded=false;a.init()};OOC.AppVerCollection.prototype={init:function(){var a=this;if(!this._appVerDataLoaded){var b=Function.createDelegate(a,a.ProcessAppVerData),c=OOUtil.ScriptReference(String.format("appdetectjs.aspx?b={0}",OOUI.BuildNumber),b);OOUtil.JSAsyncLoader(c)}},ProcessAppVerData:function(){var d=this;if(typeof jsonAppVer!=="undefined"&&jsonAppVer){for(var b=0;b<jsonAppVer.sys.length;b++)for(var e=0;e<jsonAppVer.sys[b].pgs.length;e++)for(var f=0;f<jsonAppVer.sys[b].pgs[e].avs.length;f++){var c=jsonAppVer.sys[b].pgs[e].avs[f],a=new OOC.AppVerData;a.appver=c.av;a.appcode=c.ac;a.longtitle=c.lt;a.shorttitle=c.st;a.version=jsonAppVer.sys[b].v;a.system=jsonAppVer.sys[b].t;a.productgroup=jsonAppVer.sys[b].pgs[e].t;a.sysindex=b;d.AppVerList[c.av]=a}d._appVerDataLoaded=true;d._fnCallback&&d._fnCallback.apply(null,[d.AppVerList])}}};OOC.AppVerCollection.registerClass("OOC.AppVerCollection",Sys.Component);OOC.AppVerData=function(){var b=null,a=this;OOC.AppVerData.initializeBase(a);a.appver=b;a.appcode=b;a.longtitle=b;a.shorttitle=b;a.version=b;a.system=b;a.productgroup=b;a.sysindex=b};OOC.AppVerData.prototype={toString:function(){return this.shorttitle.toLowerCase()}};OOC.AppVerData.registerClass("OOC.AppVerData",Sys.Component);function StrEncodeUrlComponent(a){if(typeof a=="undefined"||null==a)return "";return encodeURIComponent(a)}String.prototype.StrReplaceParam=function(g,e){var a=this;if(!g)return a;var d,h="",k=a.indexOf("#");if(k!=-1){h=a.substr(k);d=a.replace(h,"").toUpperCase()}else d=a.toUpperCase();var j=g.toUpperCase(),b=d.indexOf("?"+j+"=");if(b<0)b=d.indexOf("&"+j+"=");if(b<0)return a;var i=d.indexOf("&",b+1);if(i<0)b--;var c=a.substring(0,b+1);if(i>=0)c+=a.substring(i+1,a.length);if(typeof e!="undefined"&&null!=e&&e.length>0){var f=c.indexOf("?")<0?"?":"&";if(c.charAt(c.length-1)==f)f="";c+=f+g+"="+e}return c+h};String.prototype.FContainsParam=function(d){if(!d)return false;var c=this.toUpperCase(),b=d.toUpperCase(),a=c.indexOf("?"+b+"=");if(a<0)a=c.indexOf("&"+b+"=");return a>=0};String.prototype.StrAddUniqueParam=function(b,a){if(null==b||null==a||"null"==a||a.length==0)return this;var c=this.StrReplaceParam(b),d=c.indexOf("?")<0?"?":"&";return c+d+b+"="+a};String.prototype.replaceAll=function(b,a){if(typeof a==="undefined"||a===null)a="";return this.replace(new RegExp(b,"g"),a)};function GetCookie(h,b){if("undefined"==typeof b)b="";var e=h+"=",g=e.length,f=document.cookie.length,a=0;while(a<f){var d=a+g;if(document.cookie.substring(a,d)==e){var c=document.cookie.indexOf(";",d);if(c==-1)c=document.cookie.length;return unescape(document.cookie.substring(d,c))}a=document.cookie.indexOf(" ",a)+1;if(a==0)break}return b}function SetPersistentCookie(e,d,a){var c=new Date,b=new Date;if(typeof a!="number")a=365;b.setTime(c.getTime()+1e3*60*60*24*a);mSetCookie(e,d,false,b);return}function FIsVariableInCookie(b,a){if("undefined"==typeof a)a=null;return a!=GetCookie(b,a)}function mSetCookie(e,d){var a=null,b=mSetCookie.arguments,c=mSetCookie.arguments.length,i=c>2?b[2]:false,f=c>3?b[3]:a,h=c>4?b[4]:"/",g=c>5?b[5]:a,j=c>6?b[6]:false;if(i&&""!=GetCookie(e))d=GetCookie(e)+","+d;document.cookie=e+"="+d+(f==a?"":"; expires="+f.toGMTString())+(h==a?"":"; path="+h)+(g==a?"":"; domain="+g)+(j==true?"; secure":"");return}function mDeleteCookie(b){var a=new Date;a.setDate(a.getDate()-10);mSetCookie(b,"",false,a)}function StrGetArgumentValue(a){var b=new RegExp("[\\?&]"+a+"=([^&]*)","i");if(!b.test(location))return null;return b.exec(location)[0].substring(a.length+2)}function StrGetQueryParamValue(b,a){var c=new RegExp("[\\?&]"+a+"=([^&#]*)","i");if(!c.test(b))return null;return c.exec(b)[0].substring(a.length+2)}var g_RatingInstanceId=null;function CommentOnThisTemplate(a){var c=StrGetArgumentValue("av"),b=StrGetArgumentValue("CategoryId");if(g_RatingInstanceId!=null)a+="&apfbkid="+StrEncodeUrlComponent(g_RatingInstanceId);if(b!=null&&b.length>0)a+="&CategoryId="+b;if(c!=null&&c.length>0)a+="&av="+c;location.href=a}function ObjGetVersionDetector(){var m="Shockwave Flash",k="Shockwave Flash 2.0",e=null,c=true,d=false,a={fPlugInSupported:d,fIsIE5AndAbove:d,fIsIE6AndLess:d,fIsIE:d},j=navigator.userAgent.toLowerCase(),i=navigator.appVersion.toLowerCase(),b,q;if(j.indexOf("win")!=-1&&j.indexOf("mac")==-1){var f=i.indexOf("msie");if(f!=-1&&j.indexOf("opera")==-1){a.fIsIE=c;b=parseInt(i.substring(f+5,i.indexOf(";",f)));if(!isNaN(b)&&b<7)a.fIsIE6AndLess=c;if(!isNaN(b)&&b>=5){a.fIsIE5AndAbove=c;for(var h=12;h>=7;h--)try{var p=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+h);if(p!=e){a.fPlugInSupported=c;break}}catch(n){}}}else try{if(navigator.plugins&&(navigator.plugins[k]!=e||navigator.plugins[m]!=e)){var g;if(navigator.plugins[k]!=e)g=navigator.plugins[k].description;else g=navigator.plugins[m].description;var o=g.split(" "),l=parseInt(o[2],0);if(!isNaN(l)&&l>=7)a.fPlugInSupported=c}}catch(n){}}return a}function OpenPlayer(a){var f="&origin=",c="undefined";if(a==null)throw new Error("Metadata parameter is not set.");var b=typeof g_strRenderingSiteRootRelative!=c?g_strRenderingSiteRootRelative:"/",d=typeof a.Player!=c?a.Player.toLowerCase():"",j=typeof a.DownloadAssetId!=c?a.DownloadAssetId:"",i=typeof a.Width!=c?a.Width:0,h=typeof a.Height!=c?a.Height:0,g=typeof a.Location!=c?a.Location:"",e=h;if(d=="silverlight"){b+="player.aspx?&standalone=true&autoplay=true";if(g)b+="&locat="+g;e+=36}else if(d=="mediaplayer")b+="asstvid.aspx?&type=mediaplayer";else if(d=="flash")b+="asstvid.aspx?&type=flash";else throw new Error("Unknown player parameter: "+d);b+="&assetid="+j;b+="&vwidth="+i;b+="&vheight="+h;if(typeof DCSext!==c&&typeof DCSext.oo_assetid==="string"&&DCSext.oo_assetid!=="")b+=f+DCSext.oo_assetid;else if(typeof g_strTrainingAssetId==="string"&&g_strTrainingAssetId!=="")b+=f+g_strTrainingAssetId;OpenVideo(b,i,e)}function RenderPlayer(a){var k="string",c="",b="undefined";if(a==null)throw new Error("Metadata parameter is not set.");var j=typeof g_fIsTrainingCourse!=b?g_fIsTrainingCourse:false,o=typeof g_fIsPrinterFriendlyMode!=b?g_fIsPrinterFriendlyMode:false;if(j&&o)return;var m=c;if(typeof g_nVideoPlayerIndex!=b){m=g_nVideoPlayerIndex.toString();g_nVideoPlayerIndex++}var i=typeof a.Player!=b?a.Player.toLowerCase():c,t=typeof a.Type!=b?a.Type.toLowerCase():c,h=typeof a.DownloadAssetId!=b?a.DownloadAssetId:c,s=typeof a.VideoId!=b?a.VideoId:c,p=typeof a.ThumbnailAssetId!=b?a.ThumbnailAssetId:c,f=typeof a.Width!=b?a.Width:0,e=typeof a.Height!=b?a.Height:0,q=typeof a.PlayerChannel!=b?a.PlayerChannel:c,r=typeof a.PlayerMarket!=b?a.PlayerMarket:g_llcc,n=typeof a.AutoPlay!=b?a.AutoPlay:false,g;if(typeof a.OriginId===k&&a.OriginId!==c)g=a.OriginId;else if(typeof DCSext!==b&&typeof DCSext.oo_assetid===k&&DCSext.oo_assetid!==c)g=DCSext.oo_assetid;else if(typeof g_strTrainingAssetId===k&&g_strTrainingAssetId!==c)g=g_strTrainingAssetId;else g=h;var d;if(t=="wma"){e=45;d="AudioPlayerDiv"}else if(typeof a.ParentId==k)d=a.ParentId;else d="VideoPlayerDiv"+m;if(f==0)f=j?720:400;if(e==0)e=j?540:300;if(i==="msn"){if(j)n=true;var l;if(f/e<1.5)l="Standard4x3";else l="Wide16x9";(new OOC.MsnVideoControl(h,s,f,l,n,d,g,r,q)).Render()}else if(i=="silverlight")RenderSilverlightPlayer(h,d,f,e);else if(i=="mediaplayer")RenderAudioPlayer(h,d,f,e);else if(i=="flash")RenderFlashVideoPlayer(h,p,d,f,e);else throw new Error("Unknown player parameter: "+i)}function RenderSilverlightPlayer(c,e,g,f){var a,b,d=typeof g_fIsTrainingCourse!="undefined"?g_fIsTrainingCourse:false;if(d){a="Training";b=true}else{a="HelpArticle";b=false}(new VideoControl("VideoPlayer",e,c,c,g,f,g_nMarketLcid,false,b,a)).Render()}function RenderAudioPlayer(k,j,h,f){var c='" ',b='">',i=ObjGetVersionDetector(),e=g_strRedirUrl+"?AssetId="+k+"&ext=wma",a="";a+='<div style="text-align:center;width=100%;">';var d=StrGetAudioPlayerVolumeCookie(),g=StrGetAudioPlayerMuteCookie();if(i.fIsIE5AndAbove){a+='<OBJECT id="MediaPlayer" classid="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95" width="'+h+'" height="'+f+'" type="application/x-oleobject">';a+='<PARAM NAME="src" VALUE="'+e+b;a+='<PARAM NAME="uiMode" VALUE="full">';a+='<PARAM NAME="enableContextMenu" VALUE="false">';a+='<PARAM NAME="autoStart" VALUE="true">';a+='<PARAM NAME="stretchToFit" VALUE="true">';a+='<PARAM NAME="mute" VALUE="'+g+b;a+='<PARAM NAME="volume" VALUE="'+d+b;a+="</OBJECT>"}else{a+='<embed id="MediaPlayer" type="application/x-mplayer2" ';a+='pluginspage="http://www.microsoft.com/Windows/MediaPlayer/" ';a+='src="'+e+'" align="middle" ';a+='width="'+h+c;a+='height="'+f+c;a+='mute="'+g+c;a+='volume="'+d+c;a+='showstatusbar="false">';a+="</embed>"}a+="</div>";document.write('<div id="'+j+b);document.write(a);document.write("</div>")}function StrGetAudioPlayerVolumeCookie(){var b=GetCookie("AWS_play_vol");if(b)return b;else{var a=document.getElementById("MediaPlayer");if(a){if(a.settings)return "50";if(a.Volume)return "-600"}}return "50"}function StrGetAudioPlayerMuteCookie(){return GetCookie("AWS_play_mut","false")}function RenderFlashVideoPlayer(c,j,l,b,e){var d="</div>",i='</div><div class="cdBtnR">&nbsp;</div></a></td>',h='<div class="cdBtnL">&nbsp;</div><div class="cdBtnM">',g="PlayStopFlashPlayer(",k=ObjGetVersionDetector(),f=g_strRedirUrl+"?AssetId="+j+"&ext=png",a="";a+='<div style="text-align:center;width=100%;">';a+='<div style="width='+b+'px;">';if(!k.fPlugInSupported){a+='<a href="'+f+'">';a+='<img border="0" src="'+f+'"/>';a+="</a>";a+=g_strInstallFlash}else{var m=g+e+", "+b+",'"+c+"', true);",n=g+e+", "+b+",'"+c+"', false);";a+='<div align="center">';a+='<table cellpadding="0" cellspacing="0" style="text-align:left; width:'+b+'px;"><tr><td>';a+='<table cellpadding="0" cellspacing="0"><tr>';a+='<td><a id="MediaPlayButton" href="javascript:void(0)" onclick="'+m+'" class="cdBtn">';a+=h;a+=g_strTrainingPlayAnimation;a+=i;a+='<td style="width:20px"/>';a+='<td><a id="MediaStopButton" href="javascript:void(0)" onclick="'+n+'" class="cdBtn" >';a+=h;a+=g_strTrainingRewindAnimation;a+=i;a+="</tr></table>";a+='</td></tr><tr style="height:15px" /><tr><td id="tdFlashParent">';a+=CreateFlashObject(e,b,c,false);a+="</td></tr></table></div>"}a+=d;a+=d;document.write('<div id="'+l+'">');document.write(a);document.write(d)}function PlayStopFlashPlayer(e,f,b,c){var a=$("#tdFlashParent");if(a){$("#FlashPlayer").remove();var d=CreateFlashObject(e,f,b,c);a.append(d)}}function CreateFlashObject(d,e,g,c){var b=g_strRedirUrl+"?AssetId="+g+"&ext=swf",f=ObjGetVersionDetector(),a="";if(f.fIsIE5AndAbove){a+='<OBJECT CLASSID="CLSID:D27CDB6E-AE6D-11CF-96B8-444553540000" ID="FlashPlayer" TABINDEX="-1" WIDTH="'+e+'" HEIGHT="'+d+'" BORDER="0">';a+='<PARAM NAME="Movie" VALUE="'+b+'"/>';a+='<PARAM NAME="Src" VALUE="'+b+'"/>';a+='<PARAM NAME="Menu" VALUE="true"/>';a+='<PARAM NAME="Quality" VALUE="high"/>';a+=c?'<PARAM NAME="Play" VALUE="1"/>':'<PARAM NAME="Play" VALUE="0"/>';a+='<PARAM NAME="FlashVars" VALUE=""/>';a+='<PARAM NAME="Scale" VALUE="ShowAll"/>';a+='<PARAM NAME="EmbedMovie" VALUE="0"/>';a+='<PARAM NAME="SeamlessTabbing" VALUE="1"/>';a+='<PARAM NAME="_cx" VALUE="15743"/>';a+='<PARAM NAME="_cy" VALUE="7938"/>';a+='<PARAM NAME="Base" VALUE=""/>';a+='<PARAM NAME="Wmode" VALUE="Window"/>';a+="</OBJECT>"}else{a+='<EMBED name="FlashPlayer" id="FlashPlayer" loop="false" quality="high"';a+=c?' play="true"':' play="flase"';a+=' allowscriptaccess="always" wmode="opaque" type="application/x-shockwave-flash" src="'+b+'" height="'+d+'" width="'+e+'"></EMBED>'}return a}var strIsRtl="",allDivsInPage=null,allImagesInPage=null,fExpandedAssistance=false,popupWin;function openWindow(a,c){var b="width=452,height=572,top=0,left=0,alwaysRaised=yes,toolbar=0,directories=0,menubar=0,status=1,resizable=yes,location=0,scrollbars=1,copyhistory=0";if(typeof popupWin!="object"||null==popupWin)popupWin=window.open(a,c,b);else if(!popupWin.closed)popupWin.location.href=a;else popupWin=window.open(a,c,b);popupWin.focus()}function ExpandDiv(a){var c="undefined";InitializeGlobalData();if(null==a||typeof a==c)return;var d=allDivsInPage[a];if(null==d||typeof d==c)return;d.style.display="block";var b=allImagesInPage[a+"_img"];if(null!=b&&typeof b!=c){b.src=OOUtil.GetCodeImage("general","minus.gif");b.alt=strHide}}function CollapseDiv(a){var c="undefined";InitializeGlobalData();if(null==a||typeof a==c)return;var d=allDivsInPage[a];if(null==d||typeof d==c)return;d.style.display="none";var b=allImagesInPage[a+"_img"];if(null!=b&&typeof b!=c){b.src=OOUtil.GetCodeImage("general","plus.gif");b.alt=strShow}}function ToggleDiv(a){var c="undefined";InitializeGlobalData();if(null==a||typeof a==c)return;var b=allDivsInPage[a];if(null==b||typeof b==c)return;if(b.style.display.toUpperCase()!="BLOCK")ExpandDiv(a);else CollapseDiv(a)}function AlterAllDivs(e){var d="block",c="divHideAll",b="divShowAll",a="undefined";InitializeGlobalData();if(null==allDivsInPage||typeof allDivsInPage==a)return;if(typeof allDivsInPage[b]!=a&&typeof allDivsInPage[c]!=a)if(e==d){allDivsInPage[b].style.display="none";allDivsInPage[c].style.display=d}else{allDivsInPage[b].style.display=d;allDivsInPage[c].style.display="none"}AlterAllDivsSpans(document.body.getElementsByTagName("DIV"),e);AlterAllDivsSpans(document.body.getElementsByTagName("SPAN"),e)}function AlterAllDivsSpans(a,g){var f="block",e=null,d="undefined";if(typeof a==d||e==a)return;for(var b=0;b<a.length;b++)if(typeof a[b]!=d&&e!=a[b]&&typeof a[b].id!=d&&e!=a[b].id&&a[b].id.length>0){if(0==a[b].id.indexOf("divExpCollAsst_")){var c=allImagesInPage[a[b].id+"_img"];if(g==f){a[b].style.display=f;if(typeof c!=d&&e!=c){c.src=OOUtil.GetCodeImage("general","minus.gif");c.alt=strHide}}else{a[b].style.display="none";if(typeof c!=d&&e!=c){c.src=OOUtil.GetCodeImage("general","plus.gif");c.alt=strShow}}}if(0==a[b].id.indexOf("divInlineDef_"))if(g==f)a[b].style.display="inline";else a[b].style.display="none"}}function ToggleAllDivs(){InitializeGlobalData();if(fExpandedAssistance)AlterAllDivs("none");else AlterAllDivs("block");fExpandedAssistance=!fExpandedAssistance}function InitializeGlobalData(){var e=null,d="undefined";if(d!=typeof strRtl)strIsRtl=strRtl;var c=document.body.getElementsByTagName("DIV"),b=document.body.getElementsByTagName("SPAN"),g=0,f=0;if(typeof c!=d&&e!=c)g=c.length;if(typeof b!=d&&e!=b)f=b.length;var a=0;allDivsInPage=[];for(a=0;a<g;a++)if(typeof c[a].id!=d&&e!=c[a].id&&c[a].id.length>0)allDivsInPage[c[a].id]=c[a];for(a=0;a<f;a++)if(typeof b[a].id!=d&&e!=b[a].id&&b[a].id.length>0)allDivsInPage[b[a].id]=b[a];allImagesInPage=document.body.getElementsByTagName("IMG")}function OnSeeAlsoClicked(){var d="none",e="divSeeAlso",c="divSeeAlsoHideBullet",a="divSeeAlsoShowBullet",b="undefined";InitializeGlobalData();if(null==allDivsInPage||typeof allDivsInPage==b)return;if(typeof allDivsInPage[a]!=b&&typeof allDivsInPage[c]!=b)if(allDivsInPage[a].style.display.toUpperCase()=="INLINE"){allDivsInPage[e].style.display="block";allDivsInPage[a].style.display=d;allDivsInPage[c].style.display="inline"}else{allDivsInPage[e].style.display=d;allDivsInPage[a].style.display="inline";allDivsInPage[c].style.display=d}}var QUIZ_COOKIE_NAME="QUIZ_DATA";function SetQuizCookie(c,b){var a=GetCookie(QUIZ_COOKIE_NAME);if(null!=a&&0!=a.length){var d=a.indexOf(c);if(d>=0){var e=a.indexOf(" ",d+1),g=e>0?a.substr(e):"",f=b==null?"":c+":"+b;a=a.substr(0,d)+f+g}else if(b!=null)a+=" "+c+":"+b}else a=c+":"+b;mSetCookie(QUIZ_COOKIE_NAME,a)}function StrGetQuizCookie(d){var b=GetCookie(QUIZ_COOKIE_NAME);if(null!=b&&0!=b.length){var a=b.indexOf(d);if(a>=0){a=b.indexOf(":",a+1);if(a>0){a++;var c=b.indexOf(" ",a+1);if(c==-1)return b.substr(a);else return b.substring(a,c)}}}return ""}function ShowElement(b){var a=ElmGetPageElementQuiz(b);if(a!=null)a.style.display="inline"}function ElmGetPageElementQuiz(a){if(document.all)return document.all[a];else if(document.getElementById)return document.getElementById(a);else if(document.layers)return document.MainForm.elements[a];return null}function fnMail(){var c;g_strMailToUrl=StrUpdateQuizTokens(g_strMailToUrl);var a=location.href,b=a.indexOf("?");if(b>-1)a=a.substr(0,b);c=/%Quiz_Url%%26/g;g_strMailToUrl=g_strMailToUrl.replace(c,a+"?");location.href=StrXMLDecode(g_strMailToUrl)}function fnMaintainAnswer(e){var b=e.id,c=b.indexOf("_",0),a=parseInt(b.substring(1,c)),d=b.substring(c+1);g_strUserAnswers="0"+g_strUserAnswers.substring(1,a)+d+(a==g_iTotalQuestions?"":g_strUserAnswers.substring(a+1));SetQuizCookie(g_strQuizID,g_strUserAnswers)}function SubmitAnswers(){g_strUserAnswers="1"+g_strUserAnswers.substring(1,g_strUserAnswers.length);SetQuizCookie(g_strQuizID,g_strUserAnswers);document.location.href=g_strQuizID+".aspx?ctt=6&submit=1";return true}function PreloadAnswers(){for(var b="",a=1;a<=g_iTotalQuestions;a++){b=g_strUserAnswers.charAt(a);if(b=="0")ShowElement("q"+a+"_Unanswered");else if(b==g_strCorrectAnswers.charAt(a))ShowElement("q"+a+"_Correct");else{ShowElement("q"+a+"_Incorrect");ShowElement("q"+a+"_"+b)}}g_sAvgScore!="0.0"&&g_sAvgScore!="0,0"&&ShowElement("quizMetrics")}function PreloadQuestions(){var b,c;g_strUserAnswers=StrGetQuizCookie(g_strQuizID);for(var a=1;a<=g_iTotalQuestions;a++){b=g_strUserAnswers.substring(a,a+1);if(b!="0"){c=ElmGetPageElementQuiz("q"+a+"_"+b);if(c!=null)c.checked=true}}}function StrUpdateQuizTokens(a){if(typeof a=="undefined")return "";var b;b=/%Quiz_AvgScore%/g;a=a.replace(b,g_sAvgScore);b=/%Quiz_NumberOfScores%/g;a=a.replace(b,g_iTotalUsers);b=/%Quiz_Questions%/g;a=a.replace(b,g_iTotalQuestions);b=/%Quiz_Score%/g;a=a.replace(b,g_iScore);return a}function StrXMLEncode(a){if(typeof a=="undefined")return "";a=a.replace(/&/g,"&amp;");a=a.replace(/>/g,"&gt;");a=a.replace(/</g,"&lt;");a=a.replace(/'/g,"&apos;");a=a.replace(/"/g,"&quot;");return a}function StrXMLDecode(a){if(typeof a=="undefined")return "";var b;b=/&amp;/g;a=a.replace(b,"&");b=/&gt;/g;a=a.replace(b,">");b=/&lt;/g;a=a.replace(b,"<");b=/&apos;/g;a=a.replace(b,"'");b=/&quot;/g;a=a.replace(b,'"');return a}function FIsCommentValid(a,d,c,b){if(typeof a=="undefined"||null==a){alert(d);return false}a=a.trim();if(a.length<=0){alert(d);return false}if(c>0&&a.length>c){b.length>0&&alert(b);return false}return true}function goDisplayCount(m,t,f,h){var q='</SPAN><SPAN CLASS="FeedbackWizCounterOverText">',p='<SPAN CLASS="FeedbackWizCounterStar">',e=false,d="</SPAN>",i='<SPAN CLASS="FeedbackWizCounterText">',b=true,g=null,a="undefined";if(a==typeof fDisableCounter||a==typeof fDisableCounterFirst||a==typeof fWasLastCountOver)return;var n=document.getElementById(t);if(a==typeof n||g==n)return;var k=b;if(fDisableCounter){if(fDisableCounterFirst){document.getElementById(f).innerHTML=i+strGoDisplayCountOK+d;fDisableCounterFirst=e}k=e}var s=n.value.trim(),o=m-s.length,c=g,j=e;if(a!=typeof h&&g!=h){c=document.getElementById(h);if(a!=typeof c&&g!=c)j=b}if(o>=0){if(k)document.getElementById(f).innerHTML=i+String.format(strGoDisplayCountOK,o)+d;else if(fWasLastCountOver)document.getElementById(f).innerHTML=i+strGoDisplayCountOK+d;fWasLastCountOver=e;if(j){var r=b;if(a!=typeof iFeedbackWizStarRated)r=iFeedbackWizStarRated<1||iFeedbackWizStarRated>5;if(0==s.length&&r)c.disabled=b;else c.disabled=e}}else{if(k){var l=strGoDisplayCountOver;l=String.format(l,m-o,m);document.getElementById(f).innerHTML=p+strGoDisplayCountOverStar+q+l+d}else if(!fWasLastCountOver)document.getElementById(f).innerHTML=p+strGoDisplayCountOverStar+q+strGoDisplayCountOK+d;fWasLastCountOver=b;if(j)c.disabled=b}}function FIsMac(){if(typeof window.navigator.platform!="undefined")return -1!=window.navigator.platform.toUpperCase().indexOf("MAC");else return -1!=navigator.userAgent.toUpperCase().indexOf("MAC")}function SetReturnParameterValue(a){strAxInstallReturnParameter=escape(a)}function FIsSupportedWindows(){return ("Win32"==navigator.platform||"Win64"==navigator.platform)&&-1==navigator.userAgent.indexOf("Windows 95")&&-1==navigator.userAgent.indexOf("Windows 98")&&-1==navigator.userAgent.indexOf("Windows ME")&&-1==navigator.userAgent.indexOf("Windows NT 4")&&-1==navigator.userAgent.indexOf("Windows CE")}function FIsCorrectVersion(d){var e=true,a=false,b,c,g,h,f,l;if(typeof d!="string"&&typeof strAxPermCookie!="undefined")d=GetCookie(strAxPermCookie);if(!d||"0"==d)return a;b=d.replace(/,/g,".").split(".");g=Number(b[0]);h=Number(b[1]);f=Number(b[2]);l=Number(b[3]);c=strReqVersion.split(",");var j=Number(c[0]),k=Number(c[1]),i=Number(c[2]),m=Number(c[3]);if(g>j)return e;if(g<j)return a;if(h>k)return e;if(h<k)return a;if(f>i)return e;if(f<i)return a;if(l<m)return a;return e}function LoadActiveX(c,a,b,d){var e="function";if(!$.browser.msie){typeof a==e&&a.call();return}if(typeof b!="number")b=10;if(b<=0){typeof a==e&&a.call();return}var f=typeof d!="boolean";if(f||d)if(typeof DCTRL=="object"&&DCTRL.tagName.toUpperCase()=="OBJECT"){typeof c==e&&c.call();return}else if(d){OOUtil.Timer(LoadActiveX,100,c,a,--b,true);return}OOUtil.JSAsyncLoader(OOUtil.ScriptReference(OOUI.AxControlsJsUrl,function(){LoadActiveX(c,a,b,true)},function(){LoadActiveX(c,a,--b,false)}));return}function SetActiveXInstallStatus(a){fIsActiveXInstalled=false;if(!fSupportsActiveX||fDisableActivex)return;var b=FIsCorrectVersion();if(b||a){try{while(typeof document.body!="object");DCTRL=document.createElement("object");DCTRL.id="DCTRL";DCTRL.style.display="none";DCTRL.classid=String.format("clsid:{0}",strAxClsid);$(document.body).prepend(DCTRL)}catch(c){}fIsActiveXInstalled=FIsActiveXInstalled();!fIsActiveXInstalled&&SetPersistentCookie(strAxPermCookie,"0")}}function FShouldPromptForAx(){return !(FIsVariableInCookie("AWS_DontPrompt_Sess")||FIsVariableInCookie("AWS_DontPrompt_Perm")||typeof fDisableActivex!="undefined"&&fDisableActivex)}function FIsDCTRLInstalled(){return fIsActiveXInstalled}function FInstallActiveX(d,b,f){var e=false,c="undefined";if(c==typeof fIsActiveXInstalled||c==typeof fInstallingActiveX)return e;if(c==typeof d||null==d)d=e;if(c==typeof b||null==b)b=window;if(c==typeof f||null==f)f=e;if(!fIsActiveXInstalled&&!fInstallingActiveX&&fSupportsActiveX&&(d||FShouldPromptForAx())){fInstallingActiveX=true;var a=strAxInstall;if(f)a=a.replace("{0}",escape(b.location.pathname.slice(1)+b.location.search+b.location.hash));else a=a.replace("{0}",escape(document.location.pathname.slice(1)+document.location.search+b.location.hash));a=a.replace("{1}",strAxInstallReturnParameter);if(a.indexOf("?")<0)a+="?";else a+="&";a+=strAxIDName+"="+strAxID;if(fAxVersionOverride){if(a.indexOf("?")<0)a+="?";else a+="&";a+="reqver="+escape(strReqVersion)}b.location.href=a;return e}return fIsActiveXInstalled}function StrRemoveParameterFromUrl(b,a){return b.StrReplaceParam(a)}function FIsActiveXInstalled(){var b="undefined",a;try{a=typeof DCTRL!==b&&typeof DCTRL.Version!==b}catch(c){a=false}return a}Type.registerNamespace("OOHP");OOHP.Constants=function(){};OOHP.Constants.prototype={CONTENT_ID:"_content",PAGEINDEX:"pageindex",TABNEW:"newtab",NUMBEROFROWS:"numberofrows",ONEMEDIACLIPROW:"cdOOHomepageOneClipRow",TOTALCLIPNUMBER:"totalclipnumber",NUMPERROW:"numperrow"};OOHP.Constants.registerClass("OOHP.Constants",Sys.Component);OOHP.DisplayStyleHandling=function(){};var g_OOHPConstant=null;OOHP.DisplayStyleHandling.prototype={onClickWPZoneLayerTab:function(d,c){var a="cdTabTitleActive",b=this;d.preventDefault();if($(b).hasClass(a))return;$(b).addClass(g_OOHPConstant.TABNEW);$(".cdTabTitleCommon",$(b).parent().parent().parent()).each(function(){var d="cdLayerTabContent",c="cdTabTitleInactive",b=this,e=$("#"+$(b).attr("id")+g_OOHPConstant.CONTENT_ID);if($(b).hasClass(g_OOHPConstant.TABNEW)){$(b).removeClass(c).addClass(a).removeClass(g_OOHPConstant.TABNEW);e.addClass(d).show()}else if($(b).hasClass(a)){$(b).removeClass(a).addClass(c);e.removeClass(d).hide()}else e.hide()});newexpandedhiddentab=$(b).attr("id");setTimeout(c.self.expandnewtab,250)},onClickWPZoneStackedTab:function(d,c){var a="cdStackTitleActive",b=this;d.preventDefault();if($(b).hasClass(a))return;$(b).addClass(g_OOHPConstant.TABNEW);$(".cdStackTitleCommon",$(b).parent()).each(function(){var c="cdStackTitleInactive",b=this,d=$("#"+$(b).attr("id")+g_OOHPConstant.CONTENT_ID);if($(b).hasClass(g_OOHPConstant.TABNEW)){$(b).removeClass(c).addClass(a).removeClass(g_OOHPConstant.TABNEW);d.slideDown("fast")}else if($(b).hasClass(a)){$(b).removeClass(a).addClass(c);d.slideUp("fast")}else d.hide()});newexpandedhiddentab=$(b).attr("id");setTimeout(c.self.expandnewtab,250)},expandnewtab:function(){var c=$("#"+newexpandedhiddentab),a=$("#"+c.attr("id")+g_OOHPConstant.CONTENT_ID),d=OOUtil.GetViewport(),e=OOUtil.GetScrollOffset();if(a.offset().top+a.height()>d.innerHeight+e.pageYOffset){var b=a.offset().top+a.height()-d.innerHeight+10;if(b>c.offset().top)b=c.offset().top;$("html,body").animate({scrollTop:b},1e3)}},onKeyDownTab:function(a){a.stopPropagation();a.keyCode==32&&$(this).trigger("click")},HideInactiveTabs:function(){$(".cdStackTitleInactive, .cdTabTitleInactive").each(function(){var a=$(this).attr("id")+g_OOHPConstant.CONTENT_ID;a!=null&&$("#"+a).hide()})},ProcessAllWebPartZones:function(){var a=this,d=Function.createCallback(a.onClickWPZoneStackedTab,{self:a}),c=Function.createCallback(a.onClickWPZoneLayerTab,{self:a}),b=a;$(".cdStackTitleCommon").each(function(){$(this).keydown(b.onKeyDownTab).click(d)});$(".cdTabTitleCommon").each(function(){$(this).keydown(b.onKeyDownTab).click(c)})}};OOHP.DisplayStyleHandling.registerClass("OOHP.DisplayStyleHandling",Sys.Component);OOHP.Media=function(){};OOHP.Media.prototype={Initialize:function(){$(".cdOOHomepageMediaThumbDiv").keydown(this.ThumbnailKeyDown)},ThumbnailKeyDown:function(a){switch(a.keyCode){case 13:a.stopPropagation();$(this).parent().parent().trigger("mouseenter");return false;case 32:a.stopPropagation();$("img",$(this)).filter(":first").trigger("click");return false}},PagingControl:function(){var a=this;$(".mediawpdiv").each(function(){var b=this,g=$(".mediaclipdiv",$(b)),c=$(".previousbutton",$(b)),d=$(".nextbutton",$(b));if(c==null||d==null)return;var f=Function.createCallback(a.PreviousPage,{self:a}),e=Function.createCallback(a.NextPage,{self:a});c.addClass("cdPreviousButton").click(f).hide();d.addClass("cdNextButton").click(e);$(b).data(g_OOHPConstant.PAGEINDEX,"0")})},PreviousPage:function(c,b){var a=$("#"+$(this).data("mediaclipdivid"));if(a==null)return;b.self.ChangePage(a,-1)},NextPage:function(c,b){var a=$("#"+$(this).data("mediaclipdivid"));if(a==null)return;b.self.ChangePage(a,1)},ChangePage:function(b,o){var m=".nextbutton",l=".previousbutton";if(b==null)return;var e=$("."+g_OOHPConstant.ONEMEDIACLIPROW,b);if(e.length<1)return;var c=b.data(g_OOHPConstant.NUMBEROFROWS),f;if(e.length%c==0)f=e.length/c;else f=Math.round(e.length/c+.5);for(var a=parseInt(b.data(g_OOHPConstant.PAGEINDEX)),i=a*c,d=0,d=0;d<e.length&&d<c;d++)e.eq(d+i).hide();a+=parseInt(o);a=a<0?f-1:a;a=a%f;b.data(g_OOHPConstant.PAGEINDEX,a);i=a*c;for(d=0;d<e.length&&d<c;d++){var p=e.eq(d+i);p.show()}var k,g=b.data(g_OOHPConstant.TOTALCLIPNUMBER),j=b.data(g_OOHPConstant.NUMPERROW),h=a*c*j+1,n=(a+1)*c*j<g?(a+1)*c*j:g;if(n==h)k=String.format(L_CtnNumberOutOfTotal,h,g);else k=String.format(L_CtnNumberOfPages,h,n,g);if(a==0)$(l,b).hide();else $(l,b).show();if(a==f-1)$(m,b).hide();else $(m,b).show();$(".pagingdescription",b).text(k)}};OOHP.Media.registerClass("OOHP.Media",Sys.Component);OOHP.Metrics=function(){};OOHP.Metrics.prototype={WebPartMetrics:function(){$(".cdOOHomepageWpLinkMetrics").click(function(){var a=null,e=$(this);if(e!=a){var b=[];b.push("WT.dl");b.push("1");var f=e.text();if(f==a||!f.length){var g=$("img",e);if(g.length)f="img: "+(g.attr("alt")?g.attr("alt"):g.attr("title"))}b.push("DCSext.oo_wp_linktext");b.push(f);var i=e.attr("name");if(i!=a&&i.length>0){var c;try{c=OOUtil.Deserialize(i)}catch(l){var k=String.format("WebPartMetrics: Failed to deserialize attribute 'name': {0}",c);ReportScriptError(k);c=a}if(c!=a){b.push("DCSext.oo_wp_linkid");b.push(c.la);LogToAzure(c.la)}}var j=e.closest(".cdOOHomepageWpZoneMetrics");if(j!=a){var h=j.attr("name");if(h!=a&&h.length>0){var d=OOUtil.Deserialize(h);if(d!=a){b.push("WT.ti");b.push(document.title);b.push("DCSext.oo_wp_pageid");b.push(d.pa);b.push("DCSext.oo_wp_webpartzone");b.push(d.wp);b.push("DCSext.oo_wp_moduleid");b.push(d.ma);b.push("DCSext.oo_wp_moduletitle");b.push(d.mt)}}}dcsSetVar.apply(a,b)}})},ClientHelpHomeMetrics:function(){$("a").click(function(){var a=null,e=$(this);if(e!=a){var b=[];b.push("WT.dl");b.push("1");var c=e.text();if(c==a||!c.length){var d=$("img",e);if(d.length)c="img: "+(d.attr("alt")?d.attr("alt"):d.attr("title"))}b.push("DCSext.oo_chh_linktext");b.push(c);var g=e.closest(".cdHelpHomeZoneMetrics");if(g!=a){var f=g.attr("name");if(f!=a&&f.length>0){b.push("DCSext.oo_chh_zone");b.push(f)}}dcsSetVar.apply(a,b)}})}};OOHP.Metrics.registerClass("OOHP.Metrics",Sys.Component);function RegisterSod(){}function RegisterSodDep(){}function AttachEvent(){}typeof Sys!=="undefined"&&Sys.Application.notifyScriptLoaded();function AdjustClientLinksForMetrics(a,b){$("a.cdSearchBlueLineLink:not([class~=cdExternalResultLink])").each(function(){var d=this.href,c=d.toLowerCase();if(c.indexOf("javascript:")==0||c.indexOf("outlookfeed:")==0||c.indexOf("#")==0)return;this.href=AlterClientLinkForMetrics(d,a,b)});var c=window.open;window["open"]=function(d,g,f,e){d=AlterClientLinkForMetrics(d,a,b);return c(d,g,f,e)}}function AlterClientLinkForMetrics(a,e,f){var d=a.indexOf("#"),b=d>=0?a.substr(d):"",g=a;a=a.substr(0,a.length-b.length);var c=a.indexOf("://")<0&&a.indexOf("?")<0;if(c)a="?"+a;if(a.FContainsParam("app")||a.FContainsParam("ns")||a.FContainsParam("ver")||a.FContainsParam("ver")||a.FContainsParam("products"))return g;a=a.StrAddUniqueParam("app",escape(e)).StrAddUniqueParam("ver",escape(f));if(c)a=a.substr(1);if(b.length>0)a=a+b;return a}function Realign(n,c,b,k){var h="toggle",j="right",e="left";if(typeof n!="object"||n==null)return;if(typeof k!="boolean")k=false;if(typeof b=="string"){b=b.toLowerCase();switch(b){case e:case j:case h:break;default:b=h}}else b=h;var i,m,f,a={left:0,right:0,toggle:0},g=OOUtil.GetScrollOffset();try{i=OOUtil.FIsRtl();m=$(n);f=m.outerWidth();if(typeof c=="number"){a.left=c;a.right=c-f}else if(typeof c=="object")if(typeof c.clientX=="number"){if($.browser.msie&&$.browser.version=="6.0")c.clientX+=g.pageXOffset;a.left=c.clientX;a.right=c.clientX-f}else{var o=$(c),p=o.offset();a.left=p.left;a.right=p.left+o.outerWidth()-f}else return;a.toggle=i?a.right:a.left}catch(q){return}try{var d;if(!k&&(b==e||b==j))d=a[b];else{var r=OOUtil.GetViewport(),l={left:g.pageXOffset,right:g.pageXOffset+r.innerWidth-f};d=a[b];if(d<l.left||l.right<d)if(b==h)d=i?a.left:a.right;else d=l[b==e?j:e]}m.css(e,d-($.browser.msie&&i?g.pageXOffset:0))}catch(q){}}function DialogControl(){var l="left",m="complete",k="resize scroll",d="function",f="center",j="string",c="object",a=null,o=this,h=a,b=a,i=a,e=a,n="toggle",q=false,g={close:a,change:a};function w(f,c,g,e,d,i,j){if(h==c)if(b==a)s(f,c,g,e,d,i,j);else r();else s(f,c,g,e,d,i,j)}o.Toggle=w;function s(z,v,w,o,l,x,s){if(typeof z=="undefined"||z==a)return;v=typeof v==c?v:a;w=typeof w=="boolean"?w:false;x=typeof x==j?x:w?"cdModalDialog":"cdDialog";s=typeof s==j?s:w?f:a;var y=v!=a;if(b==a&&!y&&s!=f)return;(y&&h!=v||s!=a&&n!=s)&&r();OOUtil.HideVideoControls();var B=b==a;if(B){h=v;b=u();n="toggle";e={showParams:{opacity:"show",height:"show"},showOptions:{duration:"fast",easing:"swing"},hideParams:{opacity:"hide",height:"hide"},hideOptions:{duration:"fast",easing:"swing"}};if(y)$(v).after(b);else $("body").append(b)}if(typeof l==c&&l!=a){if(typeof l.showParams==c&&l.showParams!=a)e.showParams=l.showParams;if(typeof l.showOptions==c&&l.showOptions!=a)e.showOptions=l.showOptions;if(typeof l.hideParams==c&&l.hideParams!=a)e.hideParams=l.hideParams;if(typeof l.hideOptions==c&&l.hideOptions!=a)e.hideOptions=l.hideOptions}b.removeClass();b.addClass(x);b.find(".cdDialogContent:first").empty().append(z);!B&&typeof g.change==d&&g.change.call();g.change=a;if(w)try{if(i==a)i=OOUtil.DvEnsureModalCoverExists();i.show()}catch(C){}if(typeof o==c&&o!=a){if(typeof o.close==d)g.close=o.close;if(typeof o.change==d)g.change=o.change}p(v,s);if(s!=a)n=s;var A=function(){q=false;b!=a&&b.find("a:first").focus();$(window).bind(k,t);typeof o==c&&o!=a&&typeof o.open==d&&o.open.call()};q=true;if($.browser.msie&&$.browser.version=="6.0"){b.show();A.call()}else{e.showOptions[m]=A;b.animate(e.showParams,e.showOptions)}}o.Show=s;function r(){if(b==a||q)return;if(h!=a)try{var f=$(h);if(f.is("a"))f.focus();else f.find("a:first").focus()}catch(n){}if(i!=a){i.style.display="none";i=a}var c=b;b=a;var l=g.close;g.close=a;g.change=a;var j=function(){$(window).unbind(k,t);c.empty();c.remove();typeof l==d&&l.call()};OOUtil.ShowVideoControls();if($.browser.msie&&$.browser.version=="6.0"){c.hide();j.call()}else{e.hideOptions[m]=j;c.animate(e.hideParams,e.hideOptions)}}o.Close=r;function v(){return h}o.GetParentObj=v;function p(e,d){var g="position";e=typeof e==c&&e!=a?e:h;d=typeof d==j?d:n;if(d!=f&&e==a)return;try{if(d==f){var t=OOUtil.FIsRtl(),i=OOUtil.GetScrollOffset(),k=OOUtil.GetViewport(),q=b.outerWidth(),o=b.outerHeight(),p=i.pageXOffset+(k.innerWidth-q)/2,s=i.pageYOffset+(k.innerHeight-o)/2;b.css(l,p-($.browser.msie&&t?i.pageXOffset:0));b.css("top",s)}else if(d=="embedded")b.css(g,"relative").css("clear","both").css("top","").css(l,"");else{var m=$(e),r=m.offset();b.css(g,"absolute").css("top",r.top+m.outerHeight());Realign(b.get(0),e,d)}}catch(u){}}function u(){var a="font-family",d=OOUtil.FIsRtl(),b=$("<DIV />").css("display","none").css("text-align",d?"right":l).css(a,$("body").css(a)),c=$("<DIV />").addClass("cdDialogContent");b.bind("click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave",function(a){a.stopPropagation()});return b.append(c)}function t(){if($.browser.safari)window.setTimeout(function(){p(a)},1);else p(a)}}var g_Dialog=new DialogControl;(function(a){if(!a)return;a.fn.setScalableFontSize=function(e){var f=parseFloat(e)||1,c='<div style="display:none;font-size:1em;margin:0;padding:0;line-height:1;border:0;height:auto;">&nbsp;</div>',b=jQuery(c).appendTo(a("body")),d=b.height();b.remove();this.each(function(j,i){var g=a(i),b=jQuery(c);g.after(b);var e=b.height();if(e>0){var h=d/e*f;g.css("font-size",h+"em")}b.remove()});return this}})(jQuery);(function(a){if(!a)return;a.fn.positionNear=function(c,j,i){c=a(c);if(!c||!c.jquery)return;for(var b=c.offset(),d={top:0,left:0},f=c.parents(),e=0;e<f.length;e++){var g=a(f[e]),h=g.css("position");d=g.offset();if(h=="relative"||h=="absolute"||d.top==0&&d.left==0)break}if(j!=null){b.top+=j;b.top-=d.top;this.css({top:b.top})}if(i!=null){b.left+=i;b.left-=d.left;this.css({left:b.left})}return this}})(jQuery);(function(a){if(!a)return;a.fn.readyForAbsolutePositioning=function(c){var b=function(c){if(a.browser.safari&&document.readyState!="complete"){setTimeout(function(){b(c)},50);return}c&&c()};this.ready(function(){b(c)});return this}})(jQuery);(function(a){if(!a)return;a.fn.ooSlideToggle=function(d,c){var b=a(this);if(b.is(":visible"))b.animate({height:0},{duration:d,complete:function(){b.hide();b.css({height:"auto"});c&&c()}});else{var e=b.show().height();b.css({height:0}).animate({height:e},{duration:d,complete:function(){b.css({height:"auto"});c&&c()}})}return this}})(jQuery);OOC.ProfileDetailsLoader=function(){var a=this;OOC.ProfileDetailsLoader.initializeBase(a);a.Bios=null;a.Ellipsis="...";a.callback=null;a.initialize()};OOC.ProfileDetailsLoader.prototype={initialize:function(b){var a=[];$(".cdBios .cdBio").each(function(){var d=this.id,c=$(this).attr("rel");if(d&&c&&c.length){var b=c.split(":");a.push({id:d,ai:b[0],w:b[1],t:b[2]})}});this.Bios=a;this.callback=typeof b=="function"?b:null},Load:function(){var a=this;if(!a.Bios||!a.Bios.length)return;for(var c=[],b=0;b<a.Bios.length;b++){var d=a.Bios[b].ai;if(!d||!d.length)continue;c.push({ai:a.Bios[b].ai,w:a.Bios[b].w,t:a.Bios[b].t})}typeof GlobalSvc!=="undefined"&&GlobalSvc.GetProfileInfo(c,1,Function.createDelegate(a,a.Process))},Process:function(e){var d=this;if(!e)return;for(var h=0;h<e.length;h++){var c=e[h];if(!c||!c.ai)continue;var b=null;for(var j in d.Bios)if(d.Bios[j].ai.toUpperCase()==c.ai.toUpperCase()){b=$("#"+d.Bios[j].id);break}if(!b||!b.length)continue;var i=$(".cdBioDescription",b),f=c.d;f&&f.length&&jQuery.trim(i.html()).length==0&&i.text(f);var a=$("img.cdBioImage",b),g=c.i;if(g&&g.length&&a.attr("src").indexOf("provider40x40")>-1){var k=a.clone().css({position:"absolute",zIndex:9999}).positionNear(a,0,0).insertAfter(a);a.attr({src:g});k.fadeOut("normal",function(){$(this).remove()})}}d.callback&&d.callback.apply(null,[e])}};function FormSubmit(d,c){var a=document.createElement("FORM");a.method=d;a.action=c;function b(c,d){var b=document.createElement("INPUT");b.id=c;b.name=c;b.type="hidden";b.value=d;a.appendChild(b)}this.AddParam=b;function e(){document.body.appendChild(a);a.submit();document.body.removeChild(a)}this.Submit=e}function FTOUAccepted(){var b=null,a="undefined",c=false,d=c;if(arguments.length>0)d=arguments[0];else if(typeof ctn_fIsCSC!=a)d=ctn_fIsCSC;if(typeof ctn_fAcceptedTOU==a)ctn_fAcceptedTOU=c;if(typeof ctn_fAcceptedCSTTOU==a)ctn_fAcceptedCSTTOU=c;if(typeof ctn_strTouUrl==a)ctn_strTouUrl="";if((d&&!ctn_fAcceptedCSTTOU||!d&&!ctn_fAcceptedTOU)&&ctn_strTouUrl.length!=0){mSetCookie("AWS_CheckingEULA_Sess","1");var e=b,f=b;if(typeof OOC.PageType!==a)f=OOC.PageType.Unknown;e=typeof jsonSearchResults!==a&&jsonSearchResults&&jsonSearchResults.pt!=b?jsonSearchResults.pt:f;if(typeof OOC.PageType!==a&&(e==OOC.PageType.Results||e==OOC.PageType.SeeSimilar)){var h=typeof jsonSearchResults!==a&&jsonSearchResults&&jsonSearchResults.ci!=b?jsonSearchResults.ci:"",g=typeof jsonSearchResults!=a&&typeof jsonSearchResults.li!=a&&jsonSearchResults.li!=b?jsonSearchResults.li.n:g_llcc;ClipAjaxSvc.GetCollectionDownloadTouUrl(window.location.search,window.location.hash,h,g,e,function(a){if(a)window.location.href=a})}else window.location.href=ctn_strTouUrl;return c}return true}function RedirectToTemplateDownload(a){if(a==null)return;a="TS"+a.substring(2);var b=OOUI.TEMPLATE_DOWNLOAD_URL.replace("{AssetId}",a);b+="&CTT="+OOC.CTT.DirectDownload;window.open(b,"","width=350,height=250");return false}var g_IsFromAxInstall,g_IsAxLoaded=false;OOC.SearchFilters=function(b){var a=this;OOC.SearchFilters.initializeBase(a);a._queryParamAppVer="av";a._queryParamValueMyAppVer="my";a._loggingEnabled=b?true:false;a.InitializeFilters()};OOC.SearchFilters.prototype={InitializeFilters:function(){var a="a.cdSearchFilterItemNoLink",d=this._loggingEnabled,c=function(){var a=$(this).closest(".cdSearchFilterItem"),b=a.children(".cdSearchFilters"),c=a.children("img");b.ooSlideToggle("fast");a.toggleClass("cdSearchFilterExpanded").toggleClass("cdSearchFilterCollapsed")};$(".cdSearchFilterCollapsed > img, .cdSearchFilterExpanded > img").click(c);$(a).css({cursor:"pointer"}).click(c);var b=$(".cdSearchFilterExpanded .cntPSSelected").closest(".cdSearchFilterExpanded");b.children(a).unbind("click").css({cursor:"default",color:b.children(a).css("color"),textDecoration:b.children(a).css("textDecoration")})},MoreFilters:function(b){$(".cdSearchFilterItemHiddenMore."+b).slideDown();$("#programsFilterMoreLink").hide();var a=$("#programsFilterExpandLink");a.length!=0&&a.show();$("#programsFilterLessLink").show()},LessFilters:function(b){$(".cdSearchFilterItemHiddenMore."+b).slideUp();$(".cdSearchFilterItemHiddenExpand."+b).slideUp();$("#programsFilterLessLink").hide();var a=$("#programsFilterExpandLink");a.length!=0&&a.hide();$("#programsFilterMoreLink").show()},ExpandAllFilters:function(a){$(".cdSearchFilterItemHiddenExpand."+a).slideDown();$("#programsFilterExpandLink").hide();$("#programsFilterLessLink").show()},FilterToMyPrograms:function(){var b=$("#frmSearch"),a=$("#qu")[0],c=$("<input />").attr({type:"hidden",name:this._queryParamAppVer,value:this._queryParamValueMyAppVer});if(a.defaultValue!=null&&a.defaultValue.length>0){b.find("input[name="+this._queryParamAppVer+"]").remove();b.append(c);a.value=a.defaultValue;b.submit()}else{var d=$("<form />").attr({action:document.location.href,method:"get"}).append(c);d.appendTo($("body"));d.submit()}}};OOC.SearchFilters.registerClass("OOC.SearchFilters",Sys.Component);var SearchFilters=undefined;function ScrollToObject(e){var d=document.getElementById(e),b=0,a=d;while(a){b=b+a.offsetTop;a=a.offsetParent}try{window.scrollBy(0,b)}catch(c){try{scroll(0,b)}catch(c){}}}function HookUpExpLogging(){if(typeof g_expId=="undefined")return;$("a").mouseup(function(a){LogToExpOnMouseUp(a)})}function LogToExpOnMouseUp(b){var c;if(!b)b=window.event;if(b.which)c=b.which==3;else if(b.button)c=b.button==2;if(c)return;var a;if(b.target)a=b.target;else if(b.srcElement)a=b.srcElement;if(a.nodeType==3)a=a.parentNode;if(a.parentNode&&a.tagName&&a.tagName.toLowerCase()=="img")RecordClickObservationToExP(a.parentNode,a.alt,a.id);else RecordClickObservationToExP(a,a.innerText,a.id)}function RecordClickObservationToExP(b,a,c){if(document.images&&typeof g_expId!=="undefined")(new Image).src=g_expRO+"?euid="+g_expEuid+"&Property="+g_expId+"&PageCategory="+g_expMarket+"&PageId="+g_expAssetId+"&RequestId="+g_expRequestId+"&SignedIn="+g_expIsAuthenticated+"&PageUrl="+StrEncodeUrlComponent(location.href)+"&ReferrerUrl="+StrEncodeUrlComponent(document.referrer)+"&LinkUrl="+StrEncodeUrlComponent(b)+"&LinkText="+a+"&LinkId="+c+"&LinkLocation=page&LinkWeight=1"}OOC.HoverBase=function(i,h,g,e,d){var c="function",b=null,a=this;a._idPrefix=Math.round((new Date).getTime()/1e3);OOC.HoverBase.initializeBase(a);a.dvHover=b;a.dvHoverContent=b;a.top=b;a.left=b;a.allowMouseOutToClose=true;a._width=h;a._height=g;a._DomReference=b;a._Position=b;a._VerifyPos=b;a._DomRestrictRef=b;a._DomParentRef=b;a._fnCallback=typeof e===c?e:b;a._fnMouseLeaveCallback=typeof d===c?d:b;a._fnResize=Function.createDelegate(a,function(){var a=this;a.CalculatePos();a._DomRestrictRef&&!OOUtil.FIsBrowserIEQuirks()&&a.VerifyPos();typeof a._VerifyPos===c&&a._VerifyPos(a.dvHover,a._DomReference)});var f=Function.createDelegate(a,a.KeyDown);a._fnKeyDown=function(){f.apply(b,arguments)}};OOC.HoverBase.prototype={initialize:function(a){var c=null,b=this;b.dvHover=$("<div/>").attr("id","dvHover"+b._idPrefix).addClass("dvHover dvShadowbox");b._DomReference=a.ref?$(a.ref):c;b._Position=a.pos?a.pos:c;b._VerifyPos=a.verifyPos?a.verifyPos:c;b._DomRestrictRef=a.restrict?$(a.restrict):c;b._DomParentRef=a.parentOverride?$(a.parentOverride):b._DomReference.parent()},display:function(){var a=this;if(a.dvHover==null)return;a._DomRestrictRef&&!OOUtil.FIsBrowserIEQuirks()&&a.VerifyPos();a.dvHover.fadeIn(250);a.dvHover.setScalableFontSize(1);typeof a._VerifyPos==="function"&&a._VerifyPos(a.dvHover,a._DomReference)},createcontainer:function(){var b="dvHoverContent",a=this;if(a._DomParentRef){a.dvHoverContent=$("<div/>").attr("id",b+a._idPrefix).addClass(b).appendTo(a.dvHover);a.dvHover.insertAfter(a._DomReference);var c=Function.createDelegate(a,a.MouseLeave);a.dvHover.bind("mouseleave",function(){c.call()});$(document).bind("keydown",a._fnKeyDown);a.CalculatePos();$(window).resize(a._fnResize)}},CalculatePos:function(){var d="left",c="top",a=this,b=a._DomReference.offset(),e=13,f=14;if(typeof a._Position==="function"){a._Position(a.dvHover,a._DomReference);a.top=parseInt(a.dvHover.css(c));a.left=parseInt(a.dvHover.css(d));a.top-=e/2;a.left-=f/2;a.dvHover.css(c,a.top);a.dvHover.css(d,a.left)}if(typeof a._Position==="object"){a.top=a._Position.top?a._Position.top:0;a.left=a._Position.left?a._Position.left:0}else if(typeof a._Position==="string")switch(a._Position){case "centered":a.top=b.top-84;a.left=b.left-59;break;case "inline":a.top=b.top-6;a.left=b.left-(OOUtil.FIsRtl()?a._width-a._DomParentRef.width()+5:7);break;case c:a.top=b.top-a._DomReference.height();a.left=b.left;break;case "bottom":a.top=b.top+a._DomReference.height();a.left=b.left;break;case d:a.top=b.top;a.left=b.left-a._DomReference.width();break;case "right":a.top=b.top;a.left=b.left+a._DomReference.width();break;default:a.top=0;a.left=0}a._width&&a.dvHover.width(a._width+f);a._height&&a.dvHover.height(a._height+e);a.dvHover.css(c,a.top);a.dvHover.css(d,a.left)},VerifyPos:function(){var e="top",a=this,b=a._DomParentRef.offset(),c=a._height?a._height:a.dvHover.height(),f=OOUtil.GetViewport(),d=OOUtil.GetScrollOffset();if(a.top<d.pageYOffset)a.dvHover.css(e,d.pageYOffset);else if(a.top<=b.top)a.dvHover.css(e,b.top);else if(a.top+c>f.innerHeight+d.pageYOffset)a.dvHover.css(e,f.innerHeight-c>0?d.pageYOffset+(f.innerHeight-c)-10:d.pageYOffset);else a.top+c>b.top+a._DomParentRef.height()&&a.dvHover.css(e,b.top+a._DomParentRef.height()-c);if(a.left<=b.left)a.dvHover.css("left",b.left);else a.left+a._width>=b.left+a._DomParentRef.width()&&a.dvHover.css("left",b.left+a._DomParentRef.width()-a._width)},MouseLeave:function(){var a=this;if(a.allowMouseOutToClose)if(a._fnMouseLeaveCallback)a._fnMouseLeaveCallback.call();else a.dispose()},KeyDown:function(){if(arguments.length)if(arguments[0].keyCode==Sys.UI.Key.esc)if(this._fnMouseLeaveCallback)this._fnMouseLeaveCallback.call();else this.dispose()},dispose:function(){var a=this;if(a.dvHover){a.dvHover.fadeOut(250);$(document).unbind("keydown",a._fnKeyDown);$(window).unbind("resize",a._fnResize);a.dvHover.remove();a._fnCallback&&a._fnCallback.call();a.dvHover=a.dvHoverContent=a.top=a.left=a._width=a._height=a._DomReference=a._Position=a._DomRestrictRef=a._DomParentRef=a._fnCallback=a._fnResize=a._fnKeyDown=null}}};OOC.HoverBase.registerClass("OOC.HoverBase",null,Sys.IDisposable);OOC.ModalBase=function(a){var e="function",d="undefined",c=null,b=this;if(a===c)return;OOC.ModalBase.initializeBase(b);b.dvModal=c;b.dvModalContent=c;b.dvModalCover=c;b.ancLinkSource=c;b._IsModalOpen=false;b._width=typeof a.Width!==d&&OOUtil.IsNumeric(a.Width)?a.Width:300;b._height=typeof a.Height!==d&&OOUtil.IsNumeric(a.Height)?a.Height:200;b._fnSaveCallback=typeof a.SaveCallback===e?a.SaveCallback:c;b._fnCancelCallback=typeof a.CancelCallback===e?a.CancelCallback:c;b._fnLoadCallback=typeof a.LoadCallback===e?a.LoadCallback:c;b._closeOnSave=typeof a.CloseOnSave!==d?a.CloseOnSave:true;b._fDisplayXCloseIcon=typeof a.DisplayXCloseIcon!==d?a.DisplayXCloseIcon:true;b._fEnableCloseOnEsc=typeof a.EnableCloseOnEsc!==d?a.EnableCloseOnEsc:true;b._fWindowHandlersAttached=false};OOC.ModalBase.prototype={initialize:function(){var f="dvModalContent",d="hover",c="normal",b="src",e="<div/>",a=this;if(window.ODCDialogOpened!=="undefined"&&window.ODCDialogOpened){Sys.Debug.trace("Attempted to initialize a dialog, but one was already open.");return false}if(a.dvModal!=null&&a.dvModal.length){$(a.dvModal).remove();a.dvModal=null}a.dvModal=$(e).attr("id","dvModal").addClass("cntPS1 dvModal dvShadowbox");var h=$(e).addClass("dvModalToolbar").appendTo(a.dvModal);if(a._fDisplayXCloseIcon){var i=Function.createDelegate(a,a.Close);h.append($("<a/>").append($("<img/>").attr(b,OOUI.IconCloseX).data(c,OOUI.IconCloseX).data(d,OOUI.IconCloseXHover).attr("alt",OOUI.L_BtnClose)).attr({href:"javascript:void(0)",id:"ancModalCloseIcon"}).addClass("ancModalToolbarX").click(i).hover(function(){var a=$(this).children();a.attr(b,a.data(d))},function(){var a=$(this).children();a.attr(b,a.data(c))}).focus(function(){var a=$(this).children();a.attr(b,a.data(d))}).blur(function(){var a=$(this).children();a.attr(b,a.data(c))}))}a.dvModalContent=$(e).attr("id",f).addClass(f).appendTo(a.dvModal);a._width&&a.dvModal.width(a._width);a._height&&a.dvModal.height(a._height);var g=Function.createDelegate(a,a.Keydown);$(document.body).keydown(g)},display:function(e){var c="undefined",a=this;if(window.ODCDialogOpened!==c&&window.ODCDialogOpened){Sys.Debug.trace("Attempted to open a dialog, but one was already open.");return false}a.dvModalCover=$(OOUtil.DvEnsureModalCoverExists());a.dvModalCover.show();a.dvModalCover.animate({opacity:.7},"normal");OOUtil.HideVideoControls();if(typeof e!==c){a.ancLinkSource=$(e);$(a.dvModal).insertAfter(a.ancLinkSource)}else{var b=$(".cntPS1"),f=b.size()>0?b.get(b.length-1):document.body;a.dvModal.appendTo(f)}var d=a.GetModalCoords();$(a.dvModal).css({top:d.top,left:d.left});$(a.dvModal).fadeIn(300,"easeInQuart",Function.createDelegate(a,a.LoadCallback));a.dvModal.setScalableFontSize(1);$(window).resize(Function.createDelegate(a,function(){this.CheckModalLayout()}))},Close:function(a){this._fnCancelCallback&&this._fnCancelCallback.call();this.dispose(a)},Save:function(b){var a=this;a._fnSaveCallback&&a._fnSaveCallback.call();a._closeOnSave&&a.dispose(b)},Keydown:function(a){if(a&&a.keyCode){this._fEnableCloseOnEsc&&a.keyCode==Sys.UI.Key.esc&&this.Close();if(a.keyCode==Sys.UI.Key.enter)return true}},LoadCallback:function(){var b=true,a=this;window.ODCDialogOpened=b;a._IsModalOpen=b;$("A").add("INPUT").add("BUTTON").add("TEXTAREA").each(function(){var c=this,d=$(c);if(d.isChildOf(a.dvModal))return b;if(c.tabIndex==0)c.tabIndex=-1;else if(c.tabIndex>0){d.data("oldtabidx",c.tabIndex);c.tabIndex=-1}});$("INPUT:radio").prop("disabled",b);$(".cdBtn").add(".dvToolbarClose A").each(function(){this.tabIndex=0});a._fnLoadCallback&&a._fnLoadCallback.call(a);a.dvModal&&a.dvModal.css({height:""});if((typeof a.bringFocusEl==="undefined"||a.bringFocusEl===null)&&a._fDisplayXCloseIcon)a.bringFocusEl=$("#ancModalCloseIcon",a.dvModal);$(a.bringFocusEl).focus()},CheckModalLayout:function(){var a=this.GetModalCoords();this.dvModal.css("left",a.left);this.dvModal.css("top",a.top)},GetModalCoords:function(){var c=OOUtil.getClientBounds(),h=c.width,g=c.height,j=OOUtil.GetViewport(),f=OOUtil.GetScrollOffset(),b=(h-this.dvModal.width())/2,i=b>0?Math.round(b):0,d=(g-this.dvModal.height())/2,e=d>0?Math.round(d):0,a;if(e<f.pageYOffset)a=f.pageYOffset+(j.innerHeight-this.dvModal.height())/2;else a=e;return {top:a,left:i}},dispose:function(){var a=null,b=this;if(this.dvModal){$(window).unbind("resize");$(document.body).unbind("keydown");$("A").add("INPUT").add("BUTTON").add("TEXTAREA").each(function(){var b="oldtabidx",c=this,d=$(c).data(b);if(d!=a){c.tabIdex=$(c).data(b);$(c).data(b,a)}else if(c.tabIndex==-1)c.tabIndex=0});$("INPUT:radio").prop("disabled",false);var d=b.dvModalCover,c=b.ancLinkSource;b.dvModal.fadeOut(300,"easeInQuart",function(){$(this).remove();$(d).animate({opacity:0},"fast",a,function(){$(this).hide()});c&&$(c).size()===1&&c.focus();b._IsModalOpen=false;window.ODCDialogOpened=false;OOUtil.ShowVideoControls()});b.dvModal=a;b.bringFocusEl=a}}};OOC.ModalBase.registerClass("OOC.ModalBase",null,Sys.IDisposable);OOC.SignInDialog=function(){var a=this;a.Width=480;a.Height=598;a.Timer=null;OOC.SignInDialog.initializeBase(a,[{Width:a.Width,Height:a.Height}]);a.initialize()};OOC.SignInDialog.prototype={initialize:function(){OOC.SignInDialog.callBaseMethod(this,"initialize")},Open:function(b){var a=this;if(!a._IsModalOpen){(a.dvModal==null||a.dvModal.length==0)&&a.initialize();a.ancSourceElem=b;a.display()}},display:function(){this.PopulateContent();OOC.SignInDialog.callBaseMethod(this,"display",[this.ancSourceElem])},PopulateContent:function(){var c="dvModalSpinner",a=this;a.dvModal&&$(a.dvModal).attr("role","dialog");if($("#ehrd").size()==0){a.dvModalContent.removeClass("dvModalContent");$("<div/>").attr({id:c}).addClass(c).append($("<img/>").attr({alt:"",src:OOUtil.GetCodeImage("general","loading32.gif")})).appendTo(a.dvModalContent);var e=$("<iframe/>").attr({id:"ehrd",src:String.format(OOUI.EmailHRDUrl,g_PageLCID,OOUI.BuildNumber).replace("https:",window.location.protocol),scrolling:"no",frameBorder:"0"}).addClass("ehrd").appendTo(a.dvModalContent),b=function(c){if(!a.IsTrustedDomain(c))return;var b=OOUtil.Deserialize(c.data);if(typeof b==="object"&&typeof b.op==="string")switch(b.op){case "OnReady":a.DisplayEHRD();break;case "ShowNext":a.ProcessNextScreen(b);break;case "LaunchUrl":a.ProcessLaunchUrl(b);break;case "CancelDialog":a.Dispose();break;default:return}},d=window.addEventListener?"message":"onmessage";if(window.addEventListener)window.addEventListener(d,b,false);else window.attachEvent&&window.attachEvent(d,b);a.Timer=OOUtil.Timer(function(){$("#dvModalSpinner").remove();$("#ehrd").remove();var b=$("<div/>").addClass("dvModalError cntPSBlob13").text(OOUI.L_MarketplaceRegistrationFailureMessage).appendTo(a.dvModalContent)},15000)}},DisplayEHRD:function(){window.clearTimeout(this.Timer);$("#dvModalSpinner").remove();$("#ehrd").show();OOC.SignInDialog.callBaseMethod(this,"CheckModalLayout")},ProcessNextScreen:function(a){var b="username",d=parseInt(a.nextScreen),c=a.emailAddress;switch(d){case OOC.NextScreen.MSA_SignUp:window.location.href=g_SignUpUrl;break;case OOC.NextScreen.MSA_Redirect:window.location.href=g_SignInUrlMSA.StrAddUniqueParam(b,c);break;case OOC.NextScreen.OrgId_Redirect:if(typeof a.federationProvider==="string"){window.location.href=String.format(OOUI.O365GallatinPortal,a.federationProvider).StrAddUniqueParam(b,c);break}else{window.location.href=g_SignInUrlOrgId.StrAddUniqueParam(b,c);break}default:return}},ProcessLaunchUrl:function(a){window.open(a.url)},IsTrustedDomain:function(a){var c=a.origin.substring(a.origin.lastIndexOf("/")+1),b=OOUI.EmailHRDTrustDomain.substring(OOUI.EmailHRDTrustDomain.lastIndexOf("/")+1);return c===b},Dispose:function(){window.clearTimeout(this.Timer);OOC.SignInDialog.callBaseMethod(this,"dispose")}};OOC.SignInDialog.registerClass("OOC.SignInDialog",OOC.ModalBase);OOC.NextScreen=function(){};OOC.NextScreen.prototype={MSA_SignUp:0,MSA_Redirect:1,OrgId_Redirect:2};OOC.NextScreen.registerEnum("OOC.NextScreen",false);OOC.SeeAlsoHover=function(b,e,f){var c=null,a=this,h=336,g=c,d=$("#cdCntPane");if(d.length){if(!b)b={};b.parentOverride=d}OOC.SeeAlsoHover.initializeBase(a,[b,h,g,f]);a._AssetId=c;a._Type=c;a._Providers=c;a._Description=c;a._IsValidDescription=false;a._HoverOffsetLeft=10;a._HoverOffsetTop=7;a.allowMouseOutToClose=false;a._LinkElement=$(e);b.ref=a._LinkElement;b.pos=a.PositionHover;b.verifyPos=a.VerifyHover;a.initialize(b)};OOC.SeeAlsoHover.prototype={initialize:function(a){var d=null,c="undefined",b=this;if(typeof a==="object"){b._AssetId=typeof a.a!=c?a.a:d;b._Type=typeof a.t!=c?a.t:d;b._Providers=typeof a.p!=c?a.p:d;b._Description=typeof a.d!=c?a.d:d;b._IsValidDescription=typeof a.valid!=c?a.valid:false;OOC.SeeAlsoHover.callBaseMethod(b,"initialize",[a]);OOC.SeeAlsoHover.callBaseMethod(b,"createcontainer");b.dvHover.addClass("cdTextHover")}},display:function(){var c="<span />",a=this,b=$("<div/>").addClass("cdSeeAlsoWrapper"),d=$("<div />").addClass("cdSeeAlsoHeader").appendTo(b);a._Type&&a._Type.length&&$(c).addClass("cdSeeAlsoType").text(a._Type).appendTo(d);a._Providers&&a._Providers.length&&$(c).addClass("cdSeeAlsoProviders").text(a._Providers).appendTo(d);a._Description&&a._Description.length&&$("<p />").addClass("cdSeeAlsoDescription").addClass(a._IsValidDescription?"cdSeeAlsoDescriptionText":"cdSeeAlsoPrompt").text(a._Description).appendTo(b);a.dvHoverContent.append(b);OOC.SeeAlsoHover.callBaseMethod(a,"display")},PositionHover:function(d,c){var a=this,b=$(c);d.positionNear(b,b.height()+a._HoverOffsetTop,OOUtil.FIsRtl()?b.outerWidth()-a._HoverOffsetLeft-a._width:a._HoverOffsetLeft)},VerifyHover:function(a,g){var c=$(g),b=OOUtil.GetWindowSizeAndScroll(),d=b.height+b.scrollY,e=a.outerHeight()+a.position().top-20,f=b.width+b.scrollX,h=a.outerWidth()+a.position().left;d<e&&a.positionNear(c,-a.outerHeight(),null);if(f<h){var i=d<e?a:c;a.positionNear(i,null,f-a.outerWidth()-a.position().left)}}};OOC.SeeAlsoHover.registerClass("OOC.SeeAlsoHover",OOC.HoverBase);OOC.SeeAlsoControl=function(){var a=this;OOC.SeeAlsoControl.initializeBase(a);a._hoverDelay=400;a._hoverTimer=null;a.InitializeHovers()};OOC.SeeAlsoControl.prototype={InitializeHovers:function(){var e="mouseenter",b="hoverData",d="descriptionInfo";for(var g=$(".cdSeeAlso"),h=0;h<g.length;h++)for(var l=$(g[h]),j=$("a",l),i=0;i<j.length;i++){var c=$(j[i]),f=c.attr("name");if(f&&f.length)try{var a=OOUtil.Deserialize(f);if(a===undefined||!a)continue;if(a.d===undefined||!a.d&&a.d!=""){a.d=OOUI.L_SeeAlsoJustAMoment;var k={a:a.a,t:c.text(),u:a.u,uh:a.uh};c.data(d,k);c.attr("description","needed")}else a.valid=true;c.data(b,a);c.data("self",this);c.hover(this.LinkMouseIn,this.LinkMouseOut)}catch(m){}}g.bind(e,function(){var a="a[description=needed]",i=$(this);i.unbind(e);for(var g=[],h=$(a,i),f=0;f<h.length;f++){var j=$(h[f]),c=j.data(d);if(c===undefined||!c)continue;g.push(c)}if(typeof GlobalSvc==="undefined")return;GlobalSvc.GetDescriptionInfo(g_llcc,g,Function.createDelegate(this,function(f){for(var h={},e=0;e<f.length;e++){if(f[e]===undefined||!f[e])continue;h[f[e].a]=f[e].d}for(var j=$(a,$(this)),g=0;g<j.length;g++){var d=$(j[g]),c=d.data(b);if(c!==undefined&&c){var l=h[c.a];c.d=l;if(c.d===undefined||!c.d||!c.d.length)c.d=OOUI.L_SeeAlsoCantFindMore;else c.valid=true;d.data(b,c);var i=d.data("hover");if(i!==undefined&&i){var k=d.data("self");Function.createDelegate(d,k.LinkMouseOut).call();Function.createDelegate(d,k.InvokeHover).call()}}}}))})},LinkMouseIn:function(){var b=$(this);if(!b||!b.length)return;var a=b.data("self");if(!a)return;var c=b.data("hover");if(!c){a._hoverTimer&&window.clearInterval(a._hoverTimer);a._hoverTimer=OOUtil.Timer(Function.createDelegate(this,a.InvokeHover),a._hoverDelay)}},LinkMouseOut:function(){var a=$(this);if(!a||!a.length)return;var b=a.data("self");if(!b)return;b._hoverTimer&&window.clearInterval(b._hoverTimer);var c=a.data("hover");if(c){c.dispose();a.data("hover",null)}},InvokeHover:function(){var a=$(this);if(!a||!a.length)return;var b=a.data("hoverData");if(!b)return;var c=new OOC.SeeAlsoHover(b,a);a.data("hover",c);c.display()}};OOC.SeeAlsoControl.registerClass("OOC.SeeAlsoControl",Sys.Component);var SeeAlsoControl=undefined;OOC.SliderMenu=function(c,d,e){var b=null,a=this;OOC.SliderMenu.initializeBase(a);a._deactivateTimer=600;a.ancSource=b;a.dvTarget=b;a.fnActivate=b;a.fnDeactivate=b;a.fnReset=b;a.Position=b;a.MenuTimer=b;a.initialize(c,d,e)};OOC.SliderMenu.prototype={initialize:function(d,e,c){var a=this;a.ancSource=$(d);a.dvTarget=$(e);a.fnActivate=Function.createDelegate(a,a.activate);a.fnDeactivate=Function.createDelegate(a,a.deactivate);a.fnReset=Function.createDelegate(a,a.reset);a.Position=typeof c!=="undefined"?c:"Left";a.ancSource.click(a.fnActivate).attr("aria-haspopup",true);a.dvTarget.attr("role","Menu");a.dvTarget.find("a").attr("role","Menuitem");var b=a.fnDeactivate;a.dvTarget.find("a:last").keydown(function(a){a&&a.keyCode&&!a.shiftKey&&a.keyCode==Sys.UI.Key.tab&&b.call()});a.dvTarget.find("a:first").keydown(function(a){a&&a.keyCode&&a.shiftKey&&a.keyCode==Sys.UI.Key.tab&&b.call()})},activate:function(e){var a=this;e.stopPropagation&&e.stopPropagation();var c=a.fnDeactivate,f=a.fnReset,d=a.dvTarget.width()-a.ancSource.width(),b;if(a.Position==="Left")b=OOUtil.FIsRtl()?a.ancSource.offset().left-d:a.ancSource.offset().left;else b=OOUtil.FIsRtl()?a.ancSource.offset().left:a.ancSource.offset().left-d;a.dvTarget.css("left",b);a.dvTarget.show(50,function(){$(document).click(c);OOUtil.Timer(function(){$(window).resize(c)},100)}).prop("aria-expanded",true)},deactivate:function(){var a=this.fnDeactivate,b=this.dvTarget;b.is(":nothidden")&&b.hide(50,function(){$(document).unbind("click",a);$(window).unbind("resize",a)}).prop("aria-expanded",false)},reset:function(){if(this.MenuTimer!=null){window.clearTimeout(this.MenuTimer);this.MenuTimer=null}}};OOC.SliderMenu.registerClass("OOC.SliderMenu",Sys.Component);OOC.ODCDialog=function(c){var b=null,d="undefined",a=this;OOC.ODCDialog.initializeBase(a,[c]);a.Header=typeof c.Header!=d?c.Header:b;a.Content=typeof c.Content!=d?c.Content:b;a.DialogType=typeof c.DialogType!=d?c.DialogType:b;a.dvHeader=b;a.dvContent=b;a.dvAltContent=b;a.dvButtons=b;a.btnOK=b;a.btnCancel=b;a.fnOKDelegate=b;a.fnCancelDelegate=b;a.bringFocusId=b;a.bringFocusEl=b;a.initialize()};OOC.ODCDialog.prototype={initialize:function(){var a=this;OOC.ODCDialog.callBaseMethod(a,"initialize");a.fnOKDelegate=Function.createDelegate(a,a.OK);a.fnCancelDelegate=Function.createDelegate(a,a.Close)},Open:function(b){var a=this;if(!a._IsModalOpen){(a.dvModal==null||a.dvModal.length===0)&&a.initialize();a.ancSourceElem=b;a.display()}},display:function(){var a=this;a.CreateContainers();a.PopulateContent();OOC.ODCDialog.callBaseMethod(a,"display",[a.ancSourceElem])},OK:function(){OOC.ODCDialog.callBaseMethod(this,"Save",[this.ancSourceElem])},Close:function(){OOC.ODCDialog.callBaseMethod(this,"Close",[this.ancSourceElem])},CreateContainers:function(){var e="dvDialogAltContent",d="dvDialogContent",c="dvDialogTopPane",b="<div/>",a=this;a.dvTopPane=$(b).attr("id",c).addClass(c).appendTo(a.dvModalContent);a.dvContent=$(b).attr("id",d).addClass(d).appendTo(a.dvModalContent);a.dvAltContent=$(b).attr("id",e).addClass(e).appendTo(a.dvModalContent);a.dvBottomPane=$(b).addClass("dvDialogBottomPane").appendTo(a.dvModalContent)},PopulateContent:function(){var f=null,c="undefined",a=this;if(a.dvModal&&a.DialogType)if(a.DialogType==="Alert")$(a.dvModal).attr("role","alertdialog");else $(a.dvModal).attr("role","dialog");if(a.Header)if(typeof a.Header.jquery!==c)a.Header.appendTo(a.dvTopPane);else{a.dvHeader=$("<h4/>").text(a.Header);a.dvHeader.appendTo(a.dvTopPane)}else a.dvTopPane.hide();if(a.Content)if(typeof a.Content.jquery!==c)a.Content.appendTo(a.dvContent);else $("<p/>").text(a.Content).appendTo(a.dvContent);if(a.DialogType==="Spinner")$(a.dvAltContent).append($("<img/>").attr({alt:"",src:OOUtil.GetCodeImage("general","loading32.gif")}));else a.dvAltContent.hide();var d=f,g=f,e=f,b=f;if(a.btnCancel&&typeof a.btnCancel.jquery!==c||a.btnOK&&typeof a.btnOK.jquery!==c){e=a.btnOK;b=a.btnCancel}else{if(a.DialogType!=f)switch(a.DialogType){case "Alert":d=OOUI.L_BtnOK;break;case "Confirm":d=OOUI.L_BtnOK;g=OOUI.L_BtnCancel;break;case "YesNo":d=OOUI.L_CtnYesLink;g=OOUI.L_CtnNoLink;break;case "SaveCancel":d=OOUI.APPSET_BTN_DONE;g=OOUI.L_BtnCancel}if(d)e=a.CreateButton(d,"Small","Grey","OK");if(g)b=a.CreateButton(g,"Small","White","Cancel")}if(e&&typeof e.jquery!==c){e.appendTo(a.dvBottomPane);if(a.bringFocusId==="OK")a.bringFocusEl=e;b&&typeof b.jquery!==c&&$("<span/>").addClass("dvDialogButtonSeparator").appendTo(a.dvBottomPane)}if(b&&typeof b.jquery!==c){b.appendTo(a.dvBottomPane);if(a.bringFocusId==="Cancel")a.bringFocusEl=b}a.dvButtons=a.dvBottomPane.find("a");a.dvButtons.size()===0&&a.dvBottomPane.hide()},CreateButton:function(e,d,c,a){var b=typeof a!=="undefined"&&a&&a==="OK"?this.fnOKDelegate:this.fnCancelDelegate;return $("<a/>").attr({href:"javascript:void(0)"}).text(e).odcbutton({size:d,color:c,click:b})}};OOC.ODCDialog.registerClass("OOC.ODCDialog",OOC.ModalBase);window.oldalert=window.alert;window.alert=function(b){if(b){var a=new OOC.ODCDialog({Width:400,Height:151,Content:b,DialogType:"Alert"});a.bringFocusId="OK";a.Open()}};window.oldconfirm=window.confirm;window.confirm=function(c,a,d){if(c,a){var b=new OOC.ODCDialog({Width:400,Height:177,Content:c,DialogType:"Confirm",SaveCallback:a,CancelCallback:d});b.bringFocusId="OK";b.Open()}};OOC.NotificationBar=function(a){var c=null,d="undefined",b=this;OOC.NotificationBar.initializeBase(b,[a]);b.Container=typeof a.Container!==d?a.Container:"#dvNotificationBar";b.Type=typeof a.Type!==d?a.Type:c;b.Title=typeof a.Title!=d?a.Title:c;b.Message=typeof a.Message!=d?a.Message:c;b.Hyperlink=typeof a.Hyperlink!=d?a.Hyperlink:c;b.Hyperlink2=typeof a.Hyperlink2!=d?a.Hyperlink2:c;b.CloseCallback=typeof a.CloseCallback!=d?a.CloseCallback:c;b.DisplayXCloseIcon=typeof a.DisplayXCloseIcon!=d?a.DisplayXCloseIcon:true;b.dvNotificationBar=c;b.dvIcon=c;b.dvContent=c;b.dvCloseX=c;b.fnCancelDelegate=c;b.IsNotificationBarOpen=false;b._initialize()};OOC.NotificationBar.prototype={_initialize:function(){var a=this;OOC.NotificationBar.callBaseMethod(a,"initialize");a.fnCancelDelegate=Function.createDelegate(a,a.Close)},Open:function(){!this.IsNotificationBarOpen&&this._display()},Close:function(){var a=this;$(this.dvNotificationBar).slideUp("fast",function(){var b=$(this);b.remove();a.Container.children().length===0&&a.Container.hide();a.IsNotificationBarOpen=false;a.CloseCallback!=null&&typeof a.CloseCallback==="function"&&a.CloseCallback.call()})},_display:function(){var g="hover",f="normal",b="src",i="ancNBHyperlink",k="spnNBMessage",j="spnNBTitle",h="undefined",e="<span/>",d=null,a=this;a.dvNotificationBar!==d&&a.dvNotificationBar.size()>0&&a.dvNotificationBar.remove();a.dvNotificationBar=$("<div/>").addClass(a._getStyleFromType());var l=a._getIconFromType();a.Type!=="ODC"&&l!==d&&a.dvNotificationBar.append($(e).addClass("spnNBIcon").append($("<img/>").addClass("imgNBIcon").attr({src:OOUtil.GetCodeImage("icons",l),alt:""})));var c=$(e).addClass("spnMessageContainer");if(a.Type==="ODC"&&a.Title!==d)if(typeof a.Title.jquery!==h)c.append($(e).addClass(j).append(a.Title));else c.append($(e).addClass(j).text(a.Title));if(a.Message!==d)if(typeof a.Message.jquery!==h)c.append($(e).addClass(k).append(a.Message));else c.append($(e).addClass(k).text(a.Message));if(a.Hyperlink!==d&&typeof a.Hyperlink.jquery!==h){!a.Hyperlink.hasClass(i)&&a.Hyperlink.addClass(i);c.append(a.Hyperlink)}if(a.Hyperlink2!==d&&typeof a.Hyperlink2.jquery!==h){!a.Hyperlink2.hasClass(i)&&a.Hyperlink2.addClass(i);c.append(a.Hyperlink2)}a.dvNotificationBar.append(c);a.DisplayXCloseIcon&&a.dvNotificationBar.append($("<a/>").append($("<img/>").attr(b,OOUI.IconCloseX).data(f,OOUI.IconCloseX).data(g,OOUI.IconCloseXHover).attr("alt",OOUI.L_BtnClose)).attr("href","javascript:void(0)").addClass("ancNBCloseX").click(a.fnCancelDelegate).hover(function(){var a=$(this).children();a.attr(b,a.data(g))},function(){var a=$(this).children();a.attr(b,a.data(f))}).focus(function(){var a=$(this).children();a.attr(b,a.data(g))}).blur(function(){var a=$(this).children();a.attr(b,a.data(f))}));if(typeof a.Container==="string")a.Container=$(a.Container);a.Type==="ODC"&&a.Container.addClass("dvNBODCOverride");a.Container.append(a.dvNotificationBar);var m=a;$(a.Container).show(0,function(){m.IsNotificationBarOpen=true})},_getStyleFromType:function(){var a="dvNBInfo";switch(this.Type){case "Alert":return "dvNBAlert";case "Error":return "dvNBError";case "Info":return a;case "ODC":return "dvNBODC";default:return a}},_getIconFromType:function(){switch(this.Type){case "Alert":return "NotificationAlert.png";case "Error":return "NotificationError.png";case "Info":return "NotificationInfo.png";default:return null}}};OOC.NotificationBar.registerClass("OOC.NotificationBar",Sys.Component);function GetStringForCanaryGuid(){return GetStringForCanaryGuidForCookie("can")}function GetStringForCanaryGuidForCookie(a){return GetCookie(a,"")}var g_ckeFrmStored="frmstored",g_htFormField={};function StoreFormFieldInCookie(a){if(a.type=="checkbox")g_htFormField[a.id]=a.checked;else g_htFormField[a.id]=a.value;mSetCookie(g_ckeFrmStored,OOUtil.Serialize(g_htFormField))}function PreFillFormFromCookie(){var c=GetCookie(g_ckeFrmStored);if(c==null||c.length==0)return;try{g_htFormField=OOUtil.Deserialize(c);for(var a in g_htFormField){var b=$("#"+a);if(b.length>0&&b[0].type=="checkbox")b.attr("checked",g_htFormField[a]);else g_htFormField[a].length>0&&b.val(g_htFormField[a])}}catch(d){}}(function(a){var y="ui-oodropdown-disabled",t="display",o="ood_init",d="undefined",s="click",x="ui-oodropdown-active",h=".ui-oodropdown",v="previous",l=":focusable",r="selected",k=true,n="value",w="ui-oodropdown-text",e=".ui-oodropdown-text",f="idx",j="change",p=".ui-oodropdown-item",g=".ui-oodropdown-dropcontainer",c=null,u="ui-oodropdown",m="<span/>",b=false,q="<div/>";a.widget("ui.oodropdown",{_appendContainer:function(){var c=a(q).addClass("ui-oodropdown-dropcontainer-wrapper"),d=a(q).addClass("ui-oodropdown-dropcontainer");c.append(d);c.insertAfter(this.ddlSelect);c.drop=b;return c},_appendControl:function(){var i="ui-oodropdown-text-active",h="ui-oodropdown-hover",l="inline-block",o=this,d=o,q=o.options,v=o.ddlSelect,t=o.dropWrapper,n=a(m).addClass("ui-oodropdown-wrapper").css({display:l,cursor:"default"}).bind("selectstart",function(){return b}).bind("mousedown",function(){return b});!q.visibleSelectedText&&n.addClass("ui-oodropdown-wrapper-noselectedtext");var k=a("<a/>").attr({href:"javascript:void(0)",role:"listbox","aria-haspopup":"true"}).addClass(u).css({display:l}).keydown(function(e){if(e&&e.keyCode&&!d.dropWrapper.drop){var h=c;if(e.keyCode===Sys.UI.Key.down&&d.currentIndex<d._getCount()){e.preventDefault();h=d.currentIndex+1}else if(e.keyCode===Sys.UI.Key.up&&d.currentIndex>0){e.preventDefault();h=d.currentIndex-1}if(h!==c){var i=t.find(g),k=i.find(p);k.each(function(e,c){if(e===h){d.ddlSelect.get(0).selectedIndex=h;d._updateControlText();d.ddlSelect.trigger(j);var g=a(c);d.currentIndex=g.data(f);return b}})}}}).hover(function(){if(!d.disabled){k.addClass(h);k.find(e).addClass(i)}},function(){if(!d.disabled){k.removeClass(h);k.find(e).removeClass(i)}}).focus(function(){if(!d.disabled){k.addClass(h);k.find(e).addClass(i)}}).blur(function(){if(!d.disabled){k.removeClass(h);k.find(e).removeClass(i)}});n.append(k);var s=a(m);q.visibleSelectedText&&s.addClass(w).css({display:l,overflow:"hidden"}).appendTo(k);var r=a(m).addClass("ui-oodropdown-arrow").append(a("<img/>").attr({src:OOUI.IconDownArrow}).attr({alt:OOUI.L_Dropdown_Control_Alt_Text}).addClass("ui-oodropdown-arrow-img")).appendTo(k);!q.visibleSelectedText&&r.addClass("ui-oodropdown-arrow-noselectedtext");n.click(function(a){if(!d.disabled){a.stopPropagation();d._toggleDropContainer()}});k.click(function(a){if(!d.disabled){a.stopPropagation();d._toggleDropContainer()}});n.insertAfter(v);return n},_createDropItem:function(i,s,p,t,u,l){var c="ui-oodropdown-item-hover",g="menuitem",e=this,h=!l||!l.IsSection?b:l.IsSection,d=a(q).addClass("ui-oodropdown-item"),r="ancOODD"+p.replaceAll(" "),k=h?a(m):a("<a href='javascript:void(0)'/>");k.addClass(h?"ui-oodropdown-section":w).css({cursor:"default"}).attr({id:r}).attr("role",g).data(n,s).text(p).appendTo(d);if(!h){d.data(f,i).hover(function(){d.addClass(c)},function(){d.removeClass(c)});k.attr("role",g).data(f,i).focus(function(){d.addClass(c)}).blur(function(){d.removeClass(c)});var o=function(c){c.stopPropagation();e.ddlSelect.get(0).selectedIndex=i;e._updateControlText();e.ddlSelect.trigger(j);e._toggleDropContainer();var b=a(this);e.currentIndex=b.data(f)};k.click(o);d.click(o)}return d},_appendItems:function(){var e=this,d=this.ddlSelect,f=this.dropWrapper,c=f.find(g);c.css({"float":"left"});d.children("optgroup").each(function(){var b=a(this);e._appendOptions(b,c,k)});e._appendOptions(d,c,b);var i=c.outerWidth(),h=c.outerHeight();c.css({"float":""});return {width:i,height:h}},_appendOptions:function(g,d,f){var c=this,e=0;g.children("option").each(function(k){var g=a(this),n=g.text(),l=g.val(),j=g.prop(r),h=g.data("DropdownItemData"),m=c._createDropItem(k,l,n,j,f,h),i=!h||!h.IsSection?b:h.IsSection;if(!i)e++;d.append(m)});c._setCount(e);d.find("a").keydown(function(b){if(b&&b.keyCode&&c.dropWrapper.drop){var d,f=OOUtil.getSrcElement(b);switch(b.keyCode){case Sys.UI.Key.down:b.preventDefault();d=a(f).parent().nextAll();break;case Sys.UI.Key.up:b.preventDefault();d=a(f).parent().prevAll();break;case Sys.UI.Key.esc:b.preventDefault();c._hide(c);break;default:c._findItem(b)}if(d&&d.length>0)for(i=0;i<d.length;i++){var e=a(d[i]).find(l);if(e.length>0){e.focus();break}}}});d.find("a:last").keydown(function(a){a&&a.keyCode&&!a.shiftKey&&a.keyCode==Sys.UI.Key.tab&&c._hide(c,"next")});d.find("a:first").keydown(function(a){a&&a.keyCode&&(a.shiftKey&&a.keyCode==Sys.UI.Key.tab)&&c._hide(c,v)})},_updateControlText:function(){var g=this,f=this.ddlSelect,c=this.controlWrapper,d=f.find("option"),b=g._formatText(d),a=c.find(e);a.text(b);a.attr("title",b)},_formatText:function(c){var b="";c.each(function(){if(a(this).prop(r))b=a(this).text()});if(b===""&&c.size()>0)b=a(c.get(0)).text();return b},_toggleDropContainer:function(){var a=this,b=a,c=a.dropWrapper;if(c.drop)a._hide(b);else a._show(b)},_show:function(b){c!=a.ui.oodropdown.drop&&b._hide();b.dropWrapper.css({top:b.controlWrapper.offset().top+b.controlWrapper.outerHeight()+"px",left:b.controlWrapper.offset().left+"px"}).show();b.controlWrapper.find(h).toggleClass(x);b.controlWrapper.find(".ui-oodropdown-arrow-img").attr({src:OOUI.IconDownArrow});b.dropWrapper.drop=k;a.ui.oodropdown.drop=b;b.dropWrapper.find(l)[b.currentIndex].focus();a(document).bind(s,b._hide);a(window).bind("resize",b._hide);a("iframe").contents().click(b._hide)},_hide:function(f,g){var e=a.ui.oodropdown.drop;if(e!==c){e.dropWrapper.hide(50,function(){if(typeof g!==d)f._setFocusToSibling(g);else typeof f!==d&&e.controlWrapper.find(h).focus()});e.controlWrapper.find(h).toggleClass(x);e.dropWrapper.drop=b;a.ui.oodropdown.drop=c;a(document).unbind(s,e._hide);a(window).unbind("resize",e._hide);a("iframe").contents().unbind(s,e._hide)}},_findItem:function(f){var e="char",j=this.dropWrapper,h=e in f&&typeof f[e]!==d&&f[e]!==c&&f[e].length==1?f[e]:c;if(h===c&&typeof f.keyCode!==d&&f.keyCode!==c&&OOUtil.IsNumeric(f.keyCode))h=String.fromCharCode(f.keyCode);if(h!==c){var i=j.find(g),k=i.find(p).find(l);k.each(function(e,d){var c=a(d);if(c.text().toUpperCase().startsWith(h.toUpperCase())){c.focus();return b}})}},_selectElement:function(c){var e=this,i=this.dropWrapper;if(typeof c==="object"){var h=i.find(g),k=h.find(".ui-oodropdown-item > a");k.each(function(h,i){var g=a(i);if(typeof c.byIndex!==d&&OOUtil.IsNumeric(c.byIndex)&&c.byIndex===h||typeof c.byValue!==d&&c.byValue.length>0&&typeof g.data(n)!==d&&c.byValue===g.data(n)||typeof c.byText!==d&&c.byText.length>0&&c.byText===g.text()){e.ddlSelect.get(0).selectedIndex=h;e._updateControlText();e.ddlSelect.trigger(j);e.currentIndex=g.data(f);return b}})}},_setFocusToSibling:function(e){var b=a(l),d=c;b.each(function(e,b){var c=a(b);if(c.hasClass(u))d=e});if(e==="next"&&d+1<b.size()){var g=b.eq(d+1).length?b.eq(d+1):b.eq(0);g.focus()}else if(e===v&&d-1>=0){var f=b.eq(d-1).length?b.eq(d-1):b.eq(0);f.focus()}},_setSize:function(f){var h=this,o=h,b=h.options,i=h.dropWrapper,k=h.controlWrapper,d;if(b.width)d=parseInt(b.width);else{d=f.width;var m=b.minWidth;if(d<m)d=m}k.find(e).width(d);var j=k.outerWidth(),l=b.maxItemsBeforeScroll!==c?o._calcItemHeight():b.maxDropHeight!==c?parseInt(b.maxDropHeight):f.height,n=f.width<j?j:f.width;a(i).width(n).height(l);i.find(g).height(l);i.hide()},_calcItemHeight:function(){var c=this,k=c,h=c.options,f=c.dropWrapper,j=c.controlWrapper,d=f.find(g),i=d.find(p),e=0;i.each(function(f,c){var g=a(c);if(f===h.maxItemsBeforeScroll){d.addClass("ui-oodropdown-dropcontainer-scroll");return b}e+=g.outerHeight()+2});return parseInt(e)+1},_setCount:function(a){this.count=a},_getCount:function(){return this.count},_init:function(){var c=this;if(typeof c.element.data(o)!==d&&c.element.data(o)){Sys.Debug.trace("Instance of oodropdown already exists for this element");return b}c.options=a.extend({},a.ui.oodropdown.defaults,this.options);var e=c.element;c.initialDisplay=e.css(t);e.css(t,"none");c.ddlSelect=e;var g=c._appendContainer();c.dropWrapper=g;var h=c._appendItems(),f=c._appendControl();c.controlWrapper=f;c._updateControlText(f,g,e);c._setSize(h);c.currentIndex=0;c.ddlSelect.data(o,k)},enable:function(){this.controlWrapper.find(h).removeClass(y);this.disabled=b},disable:function(){this.controlWrapper.find(h).addClass(y);this.disabled=k},destroy:function(){var e=this;typeof a.widget.prototype.destroy!==d&&a.widget.prototype.destroy.apply(e,arguments);e.ddlSelect.css(t,e.initialDisplay);e.ddlSelect.data(o,b);e.ddlSelect.data("oodropdown",c);e.controlWrapper.unbind().remove();e.dropWrapper.remove()}});a.extend(a.ui.oodropdown,{defaults:{width:c,maxDropHeight:c,maxItemsBeforeScroll:c,minWidth:50,visibleSelectedText:k}})})(jQuery);(function(c){var j="Disabled",i="aria-disabled",h="undefined",e="btnSelected",g="selected",b="href",d="btn",f=null,a=false;c.widget("ui.odcbutton",{_init:function(){var h="aria-pressed",j=this,g=j,i=j.options;j.disabled=a;j.orighref=f;var e=g.element,l=d+i.size,k=d+i.color;!e.hasClass(l)&&e.addClass(l);!e.hasClass(k)&&e.addClass(k);e.attr({role:"button"}).prop(h,a).hover(function(){g.onmouseenter(c(this),g)},function(){g.onmouseleave(c(this),g)}).mousedown(function(){c(this).prop(h,true)}).mouseup(function(){c(this).prop(h,a)}).bind("selectstart",function(){return a}).unbind("click");if(typeof i.click==="function")e.click(function(a){a.preventDefault();!g.disabled&&g.options.click.apply(f,[a])});else e.click(function(a){a.preventDefault();if(!g.disabled)window.location.href=e.attr(b)});i.minwidth&&OOUtil.IsNumeric(i.minwidth)&&e.css("min-width",String.format("{0}px",i.minwidth));if(i.setfocus){e.focus();e.select()}e.data("odcbutton",g)},onmouseenter:function(a,b){!b.disabled&&!a.data(g)&&a.addClass(e)},onmouseleave:function(a,b){!b.disabled&&!a.data(g)&&a.removeClass(e)},enable:function(){var c=this,g=c.options,e=c.element,f=typeof c.orighref!==h?c.orighref:"javascript:void(0)";e.prop(i,a);e.get(0).tabIndex=0;e.removeClass(d+g.color+j);e.attr(b,f);c.disabled=a},disable:function(){var c=this,f=c.options,a=c.element;a.hasClass(e)&&a.removeClass(e);a.prop(i,true);a.get(0).tabIndex=-1;a.addClass(d+f.color+j);c.orighref=a.attr(b);a.removeAttr(b);c.disabled=true},destroy:function(){typeof c.widget.prototype.destroy!=h&&c.widget.prototype.destroy.apply(this,arguments)}});c.extend(c.ui.odcbutton,{defaults:{size:"Small",color:"Grey",click:f,setfocus:a,minwidth:f}})})(jQuery);(function(a){var c="cdBtnHover",b="cdBtnDisable",d="display";a.widget("ui.oobutton",{_appendControl:function(j){var e="min-width",d="<div/>",c=this,g=this.options,b=a("<a/>").attr("href","javascript:void(0)").addClass("cdBtn").click(function(a){if(!c.disabled){a.stopPropagation();c.btnInput.trigger("click")}}).focus(function(){c.onfocus(a(this))}).blur(function(){c.onblur(a(this))}).hover(function(){c.onfocus(a(this))},function(){c.onblur(a(this))}),l=a(d).attr("id","dvBtnL").appendTo(b),h=a(d).attr("id","dvBtnM").text(j).appendTo(b),k=a(d).attr("id","dvBtnR").appendTo(b),f=c.btnInput.attr("class");f!=null&&f.length>0&&b.addClass(f);g.minwidth&&h.css(e,String.format("{0}px",g.minwidth));b.insertAfter(this.btnInput);var i=h.outerWidth()+l.outerWidth()+k.outerWidth();b.css(e,String.format("{0}px",i));if(g.setfocus){b.focus();b.select()}return b},_init:function(){var a=this,b=a.element;a.initialDisplay=b.css(d);b.css(d,"none");b.data("oobutton",a);a.btnInput=b;a.btnNewButton=a._appendControl(b.val())},onfocus:function(a){!a.hasClass(b)&&a.addClass(c)},onblur:function(a){!a.hasClass(b)&&a.removeClass(c)},enable:function(){this.btnNewButton.removeClass(b);this.btnNewButton.get(0).tabIndex=0;this.disabled=false},disable:function(){var a=this;a.btnNewButton.hasClass(c)&&a.btnNewButton.removeClass(c);a.btnNewButton.addClass(b);a.btnNewButton.get(0).tabIndex=-1;a.disabled=true},destroy:function(){var b=this;if(typeof a.widget.prototype.destroy!=="undefined"){a.widget.prototype.destroy.apply(b,arguments);b.btnInput.css(d,b.initialDisplay);b.btnNewButton.unbind().remove()}}});a.extend(a.ui.oobutton,{defaults:{minwidth:null}})})(jQuery);(function(a){var d="ancCSATBtnMouseDown",c="ancCSATBtnMouseOver",b="click";a.widget("ui.oogreenbutton",{_init:function(){var b=this,c=this.options,d=b.element;d.addClass("ancCSATBtn").focus(function(){b.onfocus(a(this))}).blur(function(){b.onblur(a(this))}).hover(function(){b.onfocus(a(this))},function(){b.onblur(a(this))}).mousedown(function(){b.onmousedown(a(this))}).mouseup(function(){b.onmouseup(a(this))});c.minwidth&&d.css("min-width",String.format("{0}px",c.minwidth))},onfocus:function(a){!a.data(b)&&a.addClass(c)},onblur:function(a){if(!a.data(b))a.removeClass(c);else a.css({position:"static"}).data(b,false).removeClass(d).removeClass(c)},onmousedown:function(a){a.css({position:"relative",left:"1px",top:"1px"}).data(b,true).addClass(d)},onmouseup:function(a){a.css({position:"static"}).data(b,false).removeClass(d)},enable:function(){this.disabled=false},disable:function(){this.disabled=true},destroy:function(){typeof a.widget.prototype.destroy!="undefined"&&a.widget.prototype.destroy.apply(this,arguments)}});a.extend(a.ui.oogreenbutton,{defaults:{minwidth:null}})})(jQuery);(function(a){a.widget("ui.ellipsis",{_init:function(){var c=this,b=this.options;return c.element.each(function(){var e="overflow",d=a(this);if(d.css(e)=="hidden"){var c=d.html(),g=d.hasClass("multiline"),f=a(this.cloneNode(true)).hide().css("position","absolute").css(e,"visible").width(g?d.width():"auto").height(g?"auto":d.height());d.after(f);var i=g?d.height():d.width();if(typeof b.maxsize==="number")i=b.maxsize;function m(){return f.height()>i}function n(){return f.width()>i}var l=g?m:n,h=-1,j="";if(b.keepext){var k=c.lastIndexOf(".",c.length-5);if(k!==-1){j=c.substring(k+1);h=h-j.length}}c.length>0&&l()&&d.attr("title",c).data("truncated",true);while(c.length>0&&l()){c=c.substr(0,c.length+h);f.html(c+"..."+j)}d.html(f.html());f.remove()}})}});a.extend(a.ui.ellipsis,{defaults:{keepext:null,maxsize:null}})})(jQuery);jQuery.fn.outerHTML=function(a){return a?this.before(a).remove():jQuery("<p>").append(this.eq(0).clone()).html()};jQuery.fn.HtmlEncode=function(){return this.each(function(){var a=jQuery(this),b=a.html();a.html(OOUtil.HtmlEncode(b))})};jQuery.fn.HtmlDecode=function(){return this.each(function(){var a=jQuery(this),b=a.html();a.html(OOUtil.HtmlDecode(b))})};jQuery.extend(jQuery.expr[":"],{nothidden:function(a){return !(jQuery(a).is(":hidden")||jQuery(a).parents(":hidden").length)}});jQuery.fn.isChildOf=function(a){return $(this).parents().filter(a).length>0};(function(a){if(!a)return;a.OOImage=function(g,e,d,h){var f="visibility",b=null,c=b;i();return c;function i(){var h="max-width";if(typeof g!="string"||g=="")return;c=a("<IMG />").css(f,"hidden");if(typeof e!="number"||e<=0)e=b;else c.css(h,e);if(typeof d!="number"||d<=0)d=b;else c.css(h,d);OOUtil.Timer(Function.createDelegate(this,k),0)}function k(){if(e!=b||d!=b){var f=a("<IMG />");f.load(j);f.attr("src",g)}else c.attr("src",g)}function j(){var k,i,j,a,l;k=this.width;j=this.height;c.attr("src",g).css(f,"visible");if(k<=0||j<=0)return;if(e!=b)i=e/k;else i=1;if(d!=b)a=d/j;else a=1;l=false;if(a<=i){if(a<1){c.width(k*a);c.height(d);l=true}}else if(i<1){c.width(e);c.height(j*i);l=true}if(h!=b){var m={w:k,h:j,fScaled:l};Function.createCallback(h,m).call()}}}})(jQuery);OOC.ClientTopNav=function(){OOC.ClientTopNav.initializeBase(this);this.initialize()};OOC.ClientTopNav.prototype={initialize:function(){var c="#help_searchText",a="#help_contentFrame",b=this;b.ResizeContentFrame();window.onresize=b.ResizeContentFrame;var d=OOUtil.GetQueryStringArray();b.isO365=d["O365"]&&d["O365"]==1?true:false;b.largeText=false;b.homeUrl="";b.searchBoxDefaultClass="";b.searchUrl="";b.selectedBtnClass="";$(a).load(function(){OOC.ClientTopNav.ApplyTextSize();OOC.ClientTopNav.AlterLinkTargets()});$("#help_back").click(function(){var b=$(a);if(b[0].contentWindow.postMessage)b[0].contentWindow.postMessage("help_historyBack","*");else{b[0].contentWindow.focus();history.back()}});$("#help_forward").click(function(){var b=$(a);if(b[0].contentWindow.postMessage)b[0].contentWindow.postMessage("help_historyForward","*");else{b[0].contentWindow.focus();history.forward()}});$("#help_home").click(function(){if(OOC.ClientTopNav.isO365)location.href=OOC.ClientTopNav.homeUrl.StrReplaceParam("helpid");else $(a)[0].src=OOC.ClientTopNav.homeUrl});$("#help_print").click(function(){$(a)[0].contentWindow.focus();window.print()});$("#help_textSize").click(function(){OOC.ClientTopNav.largeText=!OOC.ClientTopNav.largeText;OOC.ClientTopNav.ApplyTextSize()});$(c).blur(function(){if(this.value==""){this.value=OOUI.L_TopNavSearchDefaultText;$(this).addClass(OOC.ClientTopNav.searchBoxDefaultClass)}});$(c).focus(function(){var a=this;if(a.value==OOUI.L_TopNavSearchDefaultText){a.value="";$(a).removeClass(OOC.ClientTopNav.searchBoxDefaultClass)}a.select()});$(c).keypress(function(a){a.which==13&&OOC.ClientTopNav.HelpSearch(this.value)});$(c).mouseup(function(a){a.preventDefault()});$("#help_searchBtn").click(function(){OOC.ClientTopNav.HelpSearch($(c)[0].value)})},ApplyTextSize:function(){var b="#help_textSize",a=$("#help_contentFrame");if(!a[0].contentWindow.postMessage)return;if(OOC.ClientTopNav.largeText){a[0].contentWindow.postMessage("help_textSizeLarge","*");$(b).addClass(OOC.ClientTopNav.selectedBtnClass)}else{a[0].contentWindow.postMessage("help_textSizeNormal","*");$(b).removeClass(OOC.ClientTopNav.selectedBtnClass)}},AlterLinkTargets:function(){var a=$("#help_contentFrame");if(a==null||a[0]==null||a[0].contentWindow==null||!a[0].contentWindow.postMessage)return;a[0].contentWindow.postMessage("help_alterLinkTargets","*")},HelpSearch:function(a){var c="undefined",d=256,b="";if(typeof a==c||a.length<=0)return;a=a.trim();if(a.length==0||a==OOUI.L_TopNavSearchDefaultText)return;a=a.substr(0,d);a=encodeURIComponent(a);if(typeof OOC.ClientTopNav.searchUrl==c||OOC.ClientTopNav.searchUrl==null)return;b=OOC.ClientTopNav.searchUrl.replace("{QUERYTEXT}",a);$("#help_contentFrame")[0].src=b},ResizeContentFrame:function(){var a=$("#help_contentFrame");window.scrollTo(0,0);if(a.size()>0){document.body.style.maxWidth="none";document.body.style.overflow="hidden";var b=$(window).height()-a.offset().top;b>0&&a.height(b)}},PopulateO365Dropdown:function(){var c="DropdownItemData",a=OOC.ClientTopNav.o365HelpCollections;if(a){for(var d=$("#help_titleLabel"),e=OOUtil.GetQueryStringArray(),h=e["ns"]?e["ns"]:e["NS"],g=$("<select name='ddlHelpCollection'/>").attr({id:"ddlHelpCollection"}).change(function(){data=$($(this).context[$(arguments)[0].currentTarget.selectedIndex]).data(c);if(data){var a=location.href;location.href=location.href.StrReplaceParam("NS",data.Namespace).StrReplaceParam("helpid")}}).insertAfter(d),f,b=0;b<a.length;b++){f=$("<option/>").attr({title:a[b].MenuTitle}).data(c,a[b]).text(a[b].MenuTitle).appendTo(g);h==a[b].Namespace&&f.attr("selected","true")}g.oodropdown({width:18,visibleSelectedText:false});d.data("originalWidth",d.outerWidth()+1);$(".ui-oodropdown-wrapper").css("position","relative").css("top","2px")}}};OOC.ClientTopNav.registerClass("OOC.ClientTopNav",Sys.Component);OOC.ClientTopNavListener=function(){OOC.ClientTopNavListener.initializeBase(this);this.initialize()};OOC.ClientTopNavListener.prototype={initialize:function(){if(window.addEventListener)window.addEventListener("message",this.HandleMessage,false);else window.attachEvent&&window.attachEvent("onmessage",this.HandleMessage)},HandleMessage:function(a){if(a.data=="help_historyBack")history.back();else if(a.data=="help_historyForward")history.forward();else if(a.data=="help_textSizeLarge")document.body.style.fontSize="78%";else if(a.data=="help_textSizeNormal")document.body.style.fontSize="62.5%";else a.data=="help_alterLinkTargets"&&OOC.ClientTopNavListener.AlterLinkTargets()},AlterLinkTargets:function(){$("a").each(function(){var b=this.href,a=b.toLowerCase();if(a.indexOf("javascript:")==0||a.indexOf("outlookfeed:")==0)return;if(a.indexOf(document.location.host.toLowerCase())==-1||a.indexOf("/client/")==-1)this.target="_blank"})}};OOC.ClientTopNavListener.registerClass("OOC.ClientTopNavListener",Sys.Component);OOC.ClientTopNavListener=new OOC.ClientTopNavListener;(function(a){if(!a)return;a.fn.OOQuirkCSS=function(a,b){OOUtil.FIsBrowserIEQuirks()&&this.css(a,b);return this}})(jQuery);OOC.MarketOffers=function(){OOC.MarketOffers.initializeBase(this);this.initialize()};OOC.MarketOffers.prototype={initialize:function(){var a=this;a.marketCookieName="lm";a.marketUrlParamName="LiteMarket";a.offerDateUrlParamName="OfferDate";a.marketNodeName="market";a.offerNodeName="offer";a.tokenNodeName="token";a.tokenAttrName="match";a.llccAttrName="llcc";a.displayAttrName="display";a.startAttrName="start";a.isDefaultAttrName="default";a.endAttrName="end"},LoadMarketOfferXml:function(c,b){var a=Function.createDelegate(this,this.ParseOfferXml);$.ajax({type:"GET",url:"offers.xml",dataType:"xml",success:a,complete:b})},ParseOfferXml:function(e){var b="string",a=this,c=StrQSValueFromURL(document.URL,a.offerDateUrlParamName),d=typeof c===b&&c.length>0?new Date(c):new Date;a.offersByMarket=[];$(e).find(a.marketNodeName).each(function(){var c=this,h=$(c).attr(a.llccAttrName),g=$(c).attr(a.displayAttrName),f=$(c).attr(a.isDefaultAttrName);if(h!=null&&g!=null){var e=new OfferMarket(h,g,typeof f!=="undefined"&&f);$(c).find(a.offerNodeName).each(function(){var c=$(this).attr(a.startAttrName),f=$(this).attr(a.endAttrName),h=new Date(c),i=new Date(f);if((typeof c!==b||c.length===0||h<=d)&&(typeof f!==b||f.length===0||i>=d)){var g=[];$(this).find(a.tokenNodeName).each(function(){g[$(this).attr(a.tokenAttrName)]=$(this).text()});e.offers.push(g)}});e.offers.length>0&&a.offersByMarket.push(e)}})},GetOffersByMarket:function(){return this.offersByMarket},GetMarketSelectionIndex:function(e,d){var c="string",b=this;if(typeof d!==c||d.length===0)d=b.marketUrlParamName;var a=StrQSValueFromURL(document.URL,d);if(typeof a!==c||a.length===0){if(typeof e!==c||e.length===0)e=b.marketCookieName;a=GetCookie(e)}if(typeof a===c&&a.length>0)for(market in b.offersByMarket)if(a===b.offersByMarket[market].llcc)return market;for(market in b.offersByMarket)if(b.offersByMarket[market].isDefault)return market;return 0},UpdateMarketOffers:function(e,d,c,b){$("."+c).remove();var a=this.offersByMarket[e];$("."+d).each(function(){var g=this,f=this;for(offer in a.offers){var b=$(g).clone().removeClass(d).addClass(c),e=$(b).html();for(token in a.offers[offer])e=e.replace(new RegExp("{"+token+"}","g"),a.offers[offer][token]);$(b).html(e);$(f).after(b);f=b}});if(typeof b!=="string")b=this.marketCookieName;SetPersistentCookie(b,a.llcc,180)}};OOC.MarketOffers.registerClass("OOC.MarketOffers",Sys.Component);function OfferMarket(d,c,b){var a=this;a.llcc=d;a.display=c;a.isDefault=b;a.offers=[]}SetPersistentCookie("ul","1");function wtCheck(b){if(!OOUtil.IsDefined(OOUI.AWSWebTrendsDebugOn)||OOUI.AWSWebTrendsDebugOn!="1")return;var c=document.createElement("img"),a=new Sys.StringBuilder;a.append(window.location.protocol);a.append("//");a.append(window.location.host);a.append("/sites/production/oodiagnostics/wtdiag.aspx?mode=log");a.append(b.substring(b.indexOf("?")+1));c.src=a.toString()}function OnWtSucceed(){var a="undefined";if(typeof _tag!=a&&_tag&&typeof _tag.WT!=a&&_tag.WT)_tag.WT.oss=""}